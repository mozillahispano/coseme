var CryptoJS=CryptoJS||function(e,t){var n={},r=n.lib={},i=r.Base=function(){function e(){}return{extend:function(t){e.prototype=this;var n=new e;return t&&n.mixIn(t),n.hasOwnProperty("init")||(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),s=r.WordArray=i.extend({init:function(e,n){e=this.words=e||[],n!=t?this.sigBytes=n:this.sigBytes=e.length*4},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,i=e.sigBytes;this.clamp();if(r%4)for(var s=0;s<i;s++){var o=n[s>>>2]>>>24-s%4*8&255;t[r+s>>>2]|=o<<24-(r+s)%4*8}else if(n.length>65535)for(var s=0;s<i;s+=4)t[r+s>>>2]=n[s>>>2];else t.push.apply(t,n);return this.sigBytes+=i,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){var n=[];for(var r=0;r<t;r+=4)n.push(e.random()*4294967296|0);return new s.init(n,t)}}),o=n.enc={},u=o.Hex={stringify:function(e){var t=e.words,n=e.sigBytes,r=[];for(var i=0;i<n;i++){var s=t[i>>>2]>>>24-i%4*8&255;r.push((s>>>4).toString(16)),r.push((s&15).toString(16))}return r.join("")},parse:function(e){var t=e.length,n=[];for(var r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new s.init(n,t/2)}},a=o.Latin1={stringify:function(e){var t=e.words,n=e.sigBytes,r=[];for(var i=0;i<n;i++){var s=t[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(s))}return r.join("")},parse:function(e){var t=e.length,n=[];for(var r=0;r<t;r++)n[r>>>2]|=(e.charCodeAt(r)&255)<<24-r%4*8;return new s.init(n,t)}},f=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(a.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return a.parse(unescape(encodeURIComponent(e)))}},l=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){typeof e=="string"&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,o=this.blockSize,u=o*4,a=i/u;t?a=e.ceil(a):a=e.max((a|0)-this._minBufferSize,0);var f=a*o,l=e.min(f*4,i);if(f){for(var c=0;c<f;c+=o)this._doProcessBlock(r,c);var h=r.splice(0,f);n.sigBytes-=l}return new s.init(h,l)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),c=r.Hasher=l.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){e&&this._append(e);var t=this._doFinalize();return t},blockSize:16,_createHelper:function(e){return function(t,n){return(new e.init(n)).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return(new h.HMAC.init(e,n)).finalize(t)}}}),h=n.algo={};return n}(Math);CryptoJS.lib.Cipher||function(e){var t=CryptoJS,n=t.lib,r=n.Base,i=n.WordArray,s=n.BufferedBlockAlgorithm,o=t.enc,u=o.Utf8,a=o.Base64,f=t.algo,l=f.EvpKDF,c=n.Cipher=s.extend({cfg:r.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){s.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){e&&this._append(e);var t=this._doFinalize();return t},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return typeof e=="string"?N:S}return function(t){return{encrypt:function(n,r,i){return e(r).encrypt(t,n,r,i)},decrypt:function(n,r,i){return e(r).decrypt(t,n,r,i)}}}}()}),h=n.StreamCipher=c.extend({_doFinalize:function(){var e=this._process(!0);return e},blockSize:1}),p=t.mode={},d=n.BlockCipherMode=r.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),v=p.CBC=function(){function n(t,n,r){var i=this._iv;if(i){var s=i;this._iv=e}else var s=this._prevBlock;for(var o=0;o<r;o++)t[n+o]^=s[o]}var t=d.extend();return t.Encryptor=t.extend({processBlock:function(e,t){var r=this._cipher,i=r.blockSize;n.call(this,e,t,i),r.encryptBlock(e,t),this._prevBlock=e.slice(t,t+i)}}),t.Decryptor=t.extend({processBlock:function(e,t){var r=this._cipher,i=r.blockSize,s=e.slice(t,t+i);r.decryptBlock(e,t),n.call(this,e,t,i),this._prevBlock=s}}),t}(),m=t.pad={},g=m.Pkcs7={pad:function(e,t){var n=t*4,r=n-e.sigBytes%n,s=r<<24|r<<16|r<<8|r,o=[];for(var u=0;u<r;u+=4)o.push(s);var a=i.create(o,r);e.concat(a)},unpad:function(e){var t=e.words[e.sigBytes-1>>>2]&255;e.sigBytes-=t}},y=n.BlockCipher=c.extend({cfg:c.cfg.extend({mode:v,padding:g}),reset:function(){c.reset.call(this);var e=this.cfg,t=e.iv,n=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var r=n.createEncryptor;else{var r=n.createDecryptor;this._minBufferSize=1}this._mode=r.call(n,this,t&&t.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0);this._data=new i.init,this._nDataBytes=0}else{var t=this._process(!0);e.unpad(t)}return t},blockSize:4}),b=n.CipherParams=r.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),w=t.format={},E=w.OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;if(n)var r=i.create([1398893684,1701076831]).concat(n).concat(t);else var r=
t;return r.toString(a)},parse:function(e){var t=a.parse(e),n=t.words;if(n[0]==1398893684&&n[1]==1701076831){var r=i.create(n.slice(2,4));n.splice(0,4),t.sigBytes-=16}return b.create({ciphertext:t,salt:r})}},S=n.SerializableCipher=r.extend({cfg:r.extend({format:E}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var i=e.createEncryptor(n,r),s=i.finalize(t),o=i.cfg;return b.create({ciphertext:s,key:n,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){r=this.cfg.extend(r),t=this._parse(t,r.format);var i=e.createDecryptor(n,r).finalize(t.ciphertext);return i},_parse:function(e,t){return typeof e=="string"?t.parse(e,this):e}}),x=t.kdf={},T=x.OpenSSL={execute:function(e,t,n,r){r||(r=i.random(8));var s=l.create({keySize:t+n}).compute(e,r),o=i.create(s.words.slice(t),n*4);return s.sigBytes=t*4,b.create({key:s,iv:o,salt:r})}},N=n.PasswordBasedCipher=S.extend({cfg:S.cfg.extend({kdf:T}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var i=r.kdf.execute(n,e.keySize,e.ivSize);r.iv=i.iv;var s=S.encrypt.call(this,e,t,i.key,r);return s.mixIn(i),s},decrypt:function(e,t,n,r){r=this.cfg.extend(r),t=this._parse(t,r.format);var i=r.kdf.execute(n,e.keySize,e.ivSize,t.salt);r.iv=i.iv;var s=S.decrypt.call(this,e,t,i.key,r);return s}})}(),function(){var e=CryptoJS,t=e.lib,n=t.WordArray,r=e.enc,i=r.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();var i=[];for(var s=0;s<n;s+=3){var o=t[s>>>2]>>>24-s%4*8&255,u=t[s+1>>>2]>>>24-(s+1)%4*8&255,a=t[s+2>>>2]>>>24-(s+2)%4*8&255,f=o<<16|u<<8|a;for(var l=0;l<4&&s+l*.75<n;l++)i.push(r.charAt(f>>>6*(3-l)&63))}var c=r.charAt(64);if(c)while(i.length%4)i.push(c);return i.join("")},parse:function(e){var t=e.length,r=this._map,i=r.charAt(64);if(i){var s=e.indexOf(i);s!=-1&&(t=s)}var o=[],u=0;for(var a=0;a<t;a++)if(a%4){var f=r.indexOf(e.charAt(a-1))<<a%4*2,l=r.indexOf(e.charAt(a))>>>6-a%4*2;o[u>>>2]|=(f|l)<<24-u%4*8,u++}return n.create(o,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){function a(e,t,n,r,i,s,o){var u=e+(t&n|~t&r)+i+o;return(u<<s|u>>>32-s)+t}function f(e,t,n,r,i,s,o){var u=e+(t&r|n&~r)+i+o;return(u<<s|u>>>32-s)+t}function l(e,t,n,r,i,s,o){var u=e+(t^n^r)+i+o;return(u<<s|u>>>32-s)+t}function c(e,t,n,r,i,s,o){var u=e+(n^(t|~r))+i+o;return(u<<s|u>>>32-s)+t}var t=CryptoJS,n=t.lib,r=n.WordArray,i=n.Hasher,s=t.algo,o=[];(function(){for(var t=0;t<64;t++)o[t]=e.abs(e.sin(t+1))*4294967296|0})();var u=s.MD5=i.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,i=e[r];e[r]=(i<<8|i>>>24)&16711935|(i<<24|i>>>8)&4278255360}var s=this._hash.words,u=e[t+0],h=e[t+1],p=e[t+2],d=e[t+3],v=e[t+4],m=e[t+5],g=e[t+6],y=e[t+7],b=e[t+8],w=e[t+9],E=e[t+10],S=e[t+11],x=e[t+12],N=e[t+13],C=e[t+14],k=e[t+15],L=s[0],A=s[1],O=s[2],M=s[3];L=a(L,A,O,M,u,7,o[0]),M=a(M,L,A,O,h,12,o[1]),O=a(O,M,L,A,p,17,o[2]),A=a(A,O,M,L,d,22,o[3]),L=a(L,A,O,M,v,7,o[4]),M=a(M,L,A,O,m,12,o[5]),O=a(O,M,L,A,g,17,o[6]),A=a(A,O,M,L,y,22,o[7]),L=a(L,A,O,M,b,7,o[8]),M=a(M,L,A,O,w,12,o[9]),O=a(O,M,L,A,E,17,o[10]),A=a(A,O,M,L,S,22,o[11]),L=a(L,A,O,M,x,7,o[12]),M=a(M,L,A,O,N,12,o[13]),O=a(O,M,L,A,C,17,o[14]),A=a(A,O,M,L,k,22,o[15]),L=f(L,A,O,M,h,5,o[16]),M=f(M,L,A,O,g,9,o[17]),O=f(O,M,L,A,S,14,o[18]),A=f(A,O,M,L,u,20,o[19]),L=f(L,A,O,M,m,5,o[20]),M=f(M,L,A,O,E,9,o[21]),O=f(O,M,L,A,k,14,o[22]),A=f(A,O,M,L,v,20,o[23]),L=f(L,A,O,M,w,5,o[24]),M=f(M,L,A,O,C,9,o[25]),O=f(O,M,L,A,d,14,o[26]),A=f(A,O,M,L,b,20,o[27]),L=f(L,A,O,M,N,5,o[28]),M=f(M,L,A,O,p,9,o[29]),O=f(O,M,L,A,y,14,o[30]),A=f(A,O,M,L,x,20,o[31]),L=l(L,A,O,M,m,4,o[32]),M=l(M,L,A,O,b,11,o[33]),O=l(O,M,L,A,S,16,o[34]),A=l(A,O,M,L,C,23,o[35]),L=l(L,A,O,M,h,4,o[36]),M=l(M,L,A,O,v,11,o[37]),O=l(O,M,L,A,y,16,o[38]),A=l(A,O,M,L,E,23,o[39]),L=l(L,A,O,M,N,4,o[40]),M=l(M,L,A,O,u,11,o[41]),O=l(O,M,L,A,d,16,o[42]),A=l(A,O,M,L,g,23,o[43]),L=l(L,A,O,M,w,4,o[44]),M=l(M,L,A,O,x,11,o[45]),O=l(O,M,L,A,k,16,o[46]),A=l(A,O,M,L,p,23,o[47]),L=c(L,A,O,M,u,6,o[48]),M=c(M,L,A,O,y,10,o[49]),O=c(O,M,L,A,C,15,o[50]),A=c(A,O,M,L,m,21,o[51]),L=c(L,A,O,M,x,6,o[52]),M=c(M,L,A,O,d,10,o[53]),O=c(O,M,L,A,E,15,o[54]),A=c(A,O,M,L,h,21,o[55]),L=c(L,A,O,M,b,6,o[56]),M=c(M,L,A,O,k,10,o[57]),O=c(O,M,L,A,g,15,o[58]),A=c(A,O,M,L,N,21,o[59]),L=c(L,A,O,M,v,6,o[60]),M=c(M,L,A,O,S,10,o[61]),O=c(O,M,L,A,p,15,o[62]),A=c(A,O,M,L,w,21,o[63]),s[0]=s[0]+L|0,s[1]=s[1]+A|0,s[2]=s[2]+O|0,s[3]=s[3]+M|0},_doFinalize:function(){var t=this._data,n=t.words,r=this._nDataBytes*8,i=t.sigBytes*8;n[i>>>5]|=128<<24-i%32;var s=e.floor(r/4294967296),o=r;n[(i+64>>>9<<4)+15]=(s<<8|s>>>24)&16711935|(s<<24|s>>>8)&4278255360,n[(i+64>>>9<<4)+14]=(o<<8|o>>>24)&16711935|(o<<24|o>>>8)&4278255360,t.sigBytes=(n.length+1)*4,this._process();var u=this._hash,a=u.words;for(var f=0;f<4;f++){var l=a[f];a[f]=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360}return u},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.MD5=i._createHelper(u),t.HmacMD5=i._createHmacHelper(u)}(Math),function(){function s(){var e=this._S,t=this._i,n=this._j,r=0;for(var i=0;i<4;i++){t=(t+1)%256,n=(n+e[t])%256;var s=e[t];e[t]=e[n],e[n]=s,r|=e[(e[t]+e[n])%256]<<24-i*8}return this._i=t,this._j=n,r}var e=CryptoJS,t=e.lib,n=t.StreamCipher,r=e.algo,i=r.RC4=n.extend({_doReset:function(){var e=this._key,t=e.words,n=e.sigBytes,r=this._S=[];for(var i=0;i<256;i++)r[i]=i;for(var i=0,s=0;i<256;i++){var o=i%n,u=t[o>>>2]>>>24-o%4*8&255;s=(s+r[i]+u)%256;var a=r[i];r[i]=r[s],r[s]=a}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=s.call(this)},keySize:8,ivSize:0});e.RC4=n._createHelper(i);var o=r.RC4Drop=i.extend({cfg:i.cfg.extend({drop:192}),_doReset:function(){i._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)s.call(this)}});e.RC4Drop=n._createHelper(o)}(),function(){var e=CryptoJS,t=e.lib,n=t.WordArray,r=t.Hasher,i=e.algo,s=[],o=i.SHA1=r.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102
,271733878,3285377520])},_doProcessBlock:function(e,t){var n=this._hash.words,r=n[0],i=n[1],o=n[2],u=n[3],a=n[4];for(var f=0;f<80;f++){if(f<16)s[f]=e[t+f]|0;else{var l=s[f-3]^s[f-8]^s[f-14]^s[f-16];s[f]=l<<1|l>>>31}var c=(r<<5|r>>>27)+a+s[f];f<20?c+=(i&o|~i&u)+1518500249:f<40?c+=(i^o^u)+1859775393:f<60?c+=(i&o|i&u|o&u)-1894007588:c+=(i^o^u)-899497514,a=u,u=o,o=i<<30|i>>>2,i=r,r=c}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+u|0,n[4]=n[4]+a|0},_doFinalize:function(){var e=this._data,t=e.words,n=this._nDataBytes*8,r=e.sigBytes*8;return t[r>>>5]|=128<<24-r%32,t[(r+64>>>9<<4)+14]=Math.floor(n/4294967296),t[(r+64>>>9<<4)+15]=n,e.sigBytes=t.length*4,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=r._createHelper(o),e.HmacSHA1=r._createHmacHelper(o)}(),function(e){var t=CryptoJS,n=t.lib,r=n.WordArray,i=n.Hasher,s=t.algo,o=[],u=[];(function(){function t(t){var n=e.sqrt(t);for(var r=2;r<=n;r++)if(!(t%r))return!1;return!0}function n(e){return(e-(e|0))*4294967296|0}var r=2,i=0;while(i<64)t(r)&&(i<8&&(o[i]=n(e.pow(r,.5))),u[i]=n(e.pow(r,1/3)),i++),r++})();var a=[],f=s.SHA256=i.extend({_doReset:function(){this._hash=new r.init(o.slice(0))},_doProcessBlock:function(e,t){var n=this._hash.words,r=n[0],i=n[1],s=n[2],o=n[3],f=n[4],l=n[5],c=n[6],h=n[7];for(var p=0;p<64;p++){if(p<16)a[p]=e[t+p]|0;else{var d=a[p-15],v=(d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3,m=a[p-2],g=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;a[p]=v+a[p-7]+g+a[p-16]}var y=f&l^~f&c,b=r&i^r&s^i&s,w=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),E=(f<<26|f>>>6)^(f<<21|f>>>11)^(f<<7|f>>>25),S=h+E+y+u[p]+a[p],x=w+b;h=c,c=l,l=f,f=o+S|0,o=s,s=i,i=r,r=S+x|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+s|0,n[3]=n[3]+o|0,n[4]=n[4]+f|0,n[5]=n[5]+l|0,n[6]=n[6]+c|0,n[7]=n[7]+h|0},_doFinalize:function(){var t=this._data,n=t.words,r=this._nDataBytes*8,i=t.sigBytes*8;return n[i>>>5]|=128<<24-i%32,n[(i+64>>>9<<4)+14]=e.floor(r/4294967296),n[(i+64>>>9<<4)+15]=r,t.sigBytes=n.length*4,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=i._createHelper(f),t.HmacSHA256=i._createHmacHelper(f)}(Math),function(){var e=CryptoJS,t=e.lib,n=t.Base,r=e.enc,i=r.Utf8,s=e.algo,o=s.HMAC=n.extend({init:function(e,t){e=this._hasher=new e.init,typeof t=="string"&&(t=i.parse(t));var n=e.blockSize,r=n*4;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();var s=this._oKey=t.clone(),o=this._iKey=t.clone(),u=s.words,a=o.words;for(var f=0;f<n;f++)u[f]^=1549556828,a[f]^=909522486;s.sigBytes=o.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);t.reset();var r=t.finalize(this._oKey.clone().concat(n));return r}})}(),function(){var e=CryptoJS,t=e.lib,n=t.Base,r=t.WordArray,i=e.algo,s=i.SHA1,o=i.HMAC,u=i.PBKDF2=n.extend({cfg:n.extend({keySize:4,hasher:s,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){var n=this.cfg,i=o.create(n.hasher,e),s=r.create(),u=r.create([1]),a=s.words,f=u.words,l=n.keySize,c=n.iterations;while(a.length<l){var h=i.update(t).finalize(u);i.reset();var p=h.words,d=p.length,v=h;for(var m=1;m<c;m++){v=i.finalize(v),i.reset();var g=v.words;for(var y=0;y<d;y++)p[y]^=g[y]}s.concat(h),f[0]++}return s.sigBytes=l*4,s}});e.PBKDF2=function(e,t,n){return u.create(n).compute(e,t)}}(),function(){var e=CryptoJS,t=e.lib,n=t.WordArray,r=e.enc,i=r.UInt8Array={stringify:function(e){var t=e.words,n=e.sigBytes;e.clamp();var r=new Uint8Array(n);for(var i=0;i<n;i++)r[i]=t[i>>>2]>>>24-i%4*8&255;return r},parse:function(e){var t=e.length,r=[];for(var i=0;i<t;i++)r[i>>>2]|=(e[i]&255)<<24-i%4*8;return new n.init(r,t)}}}(),function(){function i(e){var t=this._S,n=this._i,r=this._j,i=4;e!==undefined&&(i=Math.min(e,i));var s=0;for(var o=0;o<i;o++){n=(n+1)%256,r=(r+t[n])%256;var u=t[n];t[n]=t[r],t[r]=u,s|=t[(t[n]+t[r])%256]<<24-o*8}return this._i=n,this._j=r,s}var e=CryptoJS,t=e.lib,n=t.StreamCipher,r=e.algo,s=r.RC4WP=r.RC4Drop.extend({_doProcessBlock:function(e,t,n){e[t]^=i.call(this,n)},update:function(){throw new Error("Update not supported!")},_append:function(e){this._data=e},_process:function(e){var t=this._data,n=t.words,r=t.sigBytes,i=this.blockSize,s=i*4,o=r/s;if(!e)throw new Error("Cannot call _process without doFlush");o=Math.ceil(o);var u=o*i,a=Math.min(u*4,r);if(u){var f=0;for(var l=0;l<u;l+=i)this._doProcessBlock(n,l,a-f),f+=4;this._data=null}return t}});e.RC4WP=n._createHelper(s)}(),function(){var e=CryptoJS,t=e.lib,n=t.WordArray,r=t.Hasher,i=e.algo,s=i.SHA1_IP=i.SHA1.extend({_append:function(e){this._data=e,this._nDataBytes+=e.sigBytes},_process:function(e){var t=this._data,r=t.words,i=t.sigBytes,s=this.blockSize,o=s*4,u=i/o;e?u=Math.ceil(u):u=Math.max((u|0)-this._minBufferSize,0);var a=u*s,f=Math.min(a*4,i),l=0;if(a)for(l=0;l<a;l+=s)this._doProcessBlock(r,l);var c=r.length,h=new Array(c-l);for(l=a;l<c;l++)h[l-a]=r[l];this._data=new n.init(h,t.sigBytes-f);return},_doFinalize:function(){this._process();var e=this._data,t=e.words,n=this._nDataBytes*8,r=e.sigBytes*8;return t[r>>>5]|=128<<24-r%32,t[(r+64>>>9<<4)+14]=Math.floor(n/4294967296),t[(r+64>>>9<<4)+15]=n,e.sigBytes=t.length*4,this._process(),this._hash}});e.SHA1_IP=r._createHelper(s),e.HmacSHA1_IP=r._createHmacHelper(s)}(),function(e){var t=CryptoJS,n=t.lib,r=n.WordArray,i=n.Hasher,s=t.algo,o=[],u=[];(function(){function t(t){var n=e.sqrt(t);for(var r=2;r<=n;r++)if(!(t%r))return!1;return!0}function n(e){return(e-(e|0))*4294967296|0}var r=2,i=0;while(i<64)t(r)&&(i<8&&(o[i]=n(e.pow(r,.5))),u[i]=n(e.pow(r,1/3)),i++),r++})();var a=[],f=s.SHA256_IP=s.SHA1_IP.extend({_doReset:function(){this._hash=new r.init(o.slice(0))},_doProcessBlock:function(e,t){var n=this._hash.words,r=n[0],i=n[1],s=n[2],o=n[3],f=n[4],l=n[5],c=n[6],h=n[7];for(var p=0;p<64;p++){if(p<16)a[p]=e[t+p]|0;else{var d=a[p-15],v=(d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3,m=a[p-2],g=(m<<15|
m>>>17)^(m<<13|m>>>19)^m>>>10;a[p]=v+a[p-7]+g+a[p-16]}var y=f&l^~f&c,b=r&i^r&s^i&s,w=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),E=(f<<26|f>>>6)^(f<<21|f>>>11)^(f<<7|f>>>25),S=h+E+y+u[p]+a[p],x=w+b;h=c,c=l,l=f,f=o+S|0,o=s,s=i,i=r,r=S+x|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+s|0,n[3]=n[3]+o|0,n[4]=n[4]+f|0,n[5]=n[5]+l|0,n[6]=n[6]+c|0,n[7]=n[7]+h|0}});t.SHA256_IP=i._createHelper(f),t.HmacSHA256_IP=i._createHmacHelper(f)}(Math),function(e){"use strict";function t(e,t){e[t.name]=t}function n(e,t){var n;for(var r in t)t.hasOwnProperty(r)&&(n=Object.getOwnPropertyDescriptor(t,r),Object.defineProperty(e,r,n))}e.CoSeMe=e.CoSeMe||{},e.CoSeMe.namespace=function(e,r){var i,s=e.split("."),o=this;for(var u=s.length;u;u--){i=s.shift();if(!i)continue;o[i]===undefined&&(o[i]={}),o=o[i];if(u===1)switch(typeof r){case"function":if(!r.name)throw new Error('Error adding constructor to "'+i+'". '+"The constructor has no name.");t(o,r);break;case"object":n(o,r);break;default:throw new Error('Error extending namespace "'+i+'". '+"Only objects or constructors can be added to "+"namespaces")}}return o}}(this),CoSeMe.namespace("crypto",function(){"use strict";return CryptoJS.MD5_IP=function(e){function a(e,t,n){t[n]=e&255,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24&255}function T(e){var t=N(e),n=N(e+1),r=N(e+2),i=N(e+3);return i<<24|r<<16|n<<8|t}function N(e){return e<i?r[e]&255:o[e-i]&255}function C(e,t){return e<<t|e>>>32-t}var t=[3614090360,3905402710,606105819,3250441966,4118548399,1200080426,2821735955,4249261313,1770035416,2336552879,4294925233,2304563134,1804603682,4254626195,2792965006,1236535329,4129170786,3225465664,643717713,3921069994,3593408605,38016083,3634488961,3889429448,568446438,3275163606,4107603335,1163531501,2850285829,4243563512,1735328473,2368359562,4294588738,2272392833,1839030562,4259657740,2763975236,1272893353,4139469664,3200236656,681279174,3936430074,3572445317,76029189,3654602809,3873151461,530742520,3299628645,4096336452,1126891415,2878612391,4237533241,1700485571,2399980690,4293915773,2240044497,1873313359,4264355552,2734768916,1309151649,4149444226,3174756917,718787259,3951481745],n=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21];e=e||[];var r=new Uint8Array(e),i=r.length,s=i+1;while(s%64!==56)s++;s+=8;var o=new Uint8Array(s-i),u=o.length;o[0]=128,a(i*8,o,u-8),a(i>>>29,o,u-4);var f=1732584193,l=4023233417,c=2562383102,h=271733878,p=[],d,v,m,g,y,b,w;for(var E=0;E<s;E+=64){for(var S=0;S<16;S++)p[S]=T(E+S*4);d=f,v=l,m=c,g=h;for(S=0;S<64;S++)S<16?(y=v&m|~v&g,b=S):S<32?(y=g&v|~g&m,b=(5*S+1)%16):S<48?(y=v^m^g,b=(3*S+5)%16):(y=m^(v|~g),b=7*S%16),w=g,g=m,m=v,v+=C(d+y+t[S]+p[b],n[S]),d=w;f=f+d&4294967295,l=l+v&4294967295,c=c+m&4294967295,h=h+g&4294967295}var x=new Uint8Array(16);return a(f,x,0),a(l,x,4),a(c,x,8),a(h,x,12),CoSeMe.utils.hex(x)},CryptoJS}()),CoSeMe.namespace("config",function(){"use strict";return{logger:!0,customLogger:null,domain:"s.whatsapp.net",groupDomain:"g.us",tokenData:{v:"2.13.21",r:"S40-2.13.21",u:"WhatsApp/2.13.21 S40Version/14.26 Device/Nokia302",d:"S40"},auth:{host:"c2.whatsapp.net",port:443,connectionOptions:{binaryType:"arraybuffer",useSSL:!1,useSecureTransport:!1},rc4Options:{drop:192},pbkdf2Options:{keySize:5,iterations:2},hmacLength:4},contacts:{url_auth:"https://sro.whatsapp.net/v2/sync/a",url_query:"https://sro.whatsapp.net/v2/sync/q",method:"POST",authData:{nc:"00000001",realm:"s.whatsapp.net",qop:"auth",digestUri:"WAWA/s.whatsapp.net",charSet:"utf-8",authMethod:"X-WAWA"}}}}()),CoSeMe.namespace("common",function(){"use strict";function t(e){this._topic=e||null,n.hasOwnProperty(e)||(t.topics[e]=!0)}function r(e,t,n){var r,s=[];for(var o=0,u=n.length;o<u;o++)r=i(n[o]),s.push(r);return s.push("~ "+t),e&&s.push("["+e+"]"),s.join(" ")}function i(e){var t;if(typeof e=="string")t=e;else if(e instanceof Error){var n=e.stack||"",r=n.replace(/\n/g," > ");t=e.name+': "'+e.message+'" at '+r}else e instanceof Date||e instanceof RegExp?t=e.toString():t=JSON.stringify(e);if(t==="{}"&&e.target&&e.type){var s=i(e.data?e.data:undefined),e=i(e.target);t=i({type:e.type,target:e.target,data:s})}return t}function s(e,t){var n=window.console;CoSeMe.config.customLogger&&(n=CoSeMe.config.customLogger),typeof n[e]!="function"&&(e="log"),n[e](t)}var e=CoSeMe.config.logger;Object.defineProperty(t,"topics",{value:{}});var n=t.topics;return t.on=function(){e=!0},t.off=function(){e=!1},t.disable=function(){Array.prototype.forEach.call(arguments,function(e){n[e]=!1})},t.enable=function(){Array.prototype.forEach.call(arguments,function(e){n[e]=!0})},t.disableAll=function(){Object.keys(n).forEach(function(e){n[e]=!1})},t.enableAll=function(){Object.keys(n).forEach(function(e){n[e]=!0})},t.select=function(e){Object.keys(e).forEach(function(t){n[t]=!!e[t]})},t.prototype.log=function(){this._message(arguments,"log")},t.prototype.warn=function(){this._message(arguments,"warn")},t.prototype.error=function(){this._message(arguments,"error")},t.prototype._message=function(t,i){if(!e||this._topic&&!n[this._topic])return;i=i||"log";var o;try{throw new Error}catch(u){o=u.stack}var a=o.split("\n")[2],f=r(this._topic,a,t);s(i,f)},t}()),CoSeMe.namespace("utils",function(){"use strict";function t(e,t){var n=CryptoJS.lib.WordArray;if(typeof e=="number"){var r,i;r=e+4,i=(r>>>2)+(r&3?1:0),this.initialByte=0,this.size=r,this.array=new n.init(new Uint32Array(i),0)}else{if(!(e instanceof Uint32Array))throw new Error("Expecting first parameter to be a number of an Uint32Array.");var s=e;this.initialByte=0,this.size=s.buffer.byteLength,this.array=new n.init(s,t||0)}}function n(e){function o(e){var t;return(t=e+1)===n?0:t}function u(e){s<i?(e.set(r.subarray(i,n)),e.set(r.subarray(0,s),n-i)):e.set(r.subarray(i,s))}var t=typeof e!="undefined"?Math.floor(e):1023,n=t+1,r=new Uint8Array(n),i=0,s=0;Object.defineProperty(this,"bufferSize",{get:function(){return t}}),Object.defineProperty(
this,"length",{get:function(){return s-i+(s<i?n:0)}}),Object.defineProperty(this,"buffer",{get:function(){var e=new Uint8Array(this.length);return u(e),e.buffer}}),this.isEmpty=function(){return i===s},this.isFull=function(){return this.length===t},this.write=function(e){this.isFull()&&this.resize(n*2),r[s]=e,s=o(s)},this.read=function(){if(this.isEmpty())return undefined;var e=r[i];return i=o(i),e},this.resize=function(e){var o=this.length,a=Math.max(Math.floor(e),o);if(a!==t){var f=a+1,l=new Uint8Array(f);u(l),t=a,n=f,r=l,i=0,s=o}return t},this.get=function(e){if(e<0||e>=this.length)throw new RangeError("index out of bounds.");var t=i+e;return t-=t>=n?n:0,r[t]},this.writeAll=function(e){for(var t=0,n=e.length;t<n;t++)this.write(e[t])}}function r(e){if(e instanceof ArrayBuffer)e=new Uint8Array(e);else if(e instanceof n)e=new Uint8Array(e.buffer);else if(e instanceof t)return CryptoJS.enc.Hex.stringify(e.buffer);var r,i="";for(var s=0,o=e.length;s<o;s++)r=e[s].toString(16),i+=r.length<2?"0"+r:r;return i}function i(t){var n=new Uint8Array(t.length),r,i,s;for(var o=0,u=t.length;o<u;o++)s=t.charCodeAt(o),r=(s&65280)>>>8,r&&e.warn("High order byte !== 0x00 in character number",o,"of ",t),i=s&255,n[o]=i;return n}function s(e){var t="",n=e.length;for(var r=0;r<n;r++)t+=String.fromCharCode(e[r]);return t}function o(e){return e.split("").map(function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return t.length<2&&(t="0"+t),"%"+t}).join("")}var e=new CoSeMe.common.Logger("utils");t.prototype={write:function(e,t){t=t||1,e<<=32-t*8;for(var n=0;n<t;n++){if(this.isFull())throw new RangeError("Cannot extend a ByteArrayWA");var r=24-n*8,i=(e&255<<r)>>>r,s=this.array.sigBytes++;this.array.words[s>>>2]|=i<<24-(s&3)*8}},read:function(){try{var e=this.get(0);return this.initialByte++,e}catch(t){return undefined}},rewind:function(e){for(var t=0;t<e;t++)this.pop()},pop:function(){var e=this.get(this.length-1),t=--this.array.sigBytes;return this.array.words[t>>>2]&=~(255<<24-(t&3)*8),e},finish:function(){var e=new Uint8Array(this.array.words.buffer),t=this.array.words,n=this.array.sigBytes>>>2,r,i;for(r=this.initialByte>>>2,i=r<<2;r<=n;r++,i+=4){var s=e[i],o=e[i+1];e[i]=e[i+3],e[i+1]=e[i+2],e[i+2]=o,e[i+3]=s}var u={offset:this.initialByte,length:this.length,buffer:e};return this.array=null,u},get length(){return this.array.sigBytes-this.initialByte},get bufferSize(){return this.size},isEmpty:function(){return this.array.sigBytes==this.initialByte},isFull:function(){return this.array.sigBytes==this.size},get:function(e){var t=this.initialByte+e;if(e<0||t>=this.array.sigBytes)throw new RangeError("index out of bounds.");var n=24-(t&3)*8;return(this.array.words[t>>>2]&255<<n)>>>n},writeAll:function(e){var t=e.words&&e.sigBytes?4:1,n=e.sigBytes||e.length;t>1&&(e=e.words);for(var r=0;n>0;n-=t,r++){var i=e[r],s=n<t?n:t;this.write(i>>>32-s*8,s)}return this}},n.fromBuffer=function(e){e instanceof ArrayBuffer&&(e=new Uint8Array(e));if(e instanceof Uint8Array){var t=new n(e.length);return t.writeAll(e),t}throw new Error("fromBuffer(buffer) only works with instances of ArrayBuffer or Uint8Array.")};var u={urlencode:function(t){var n=[];for(var r in t)if(Array.isArray(t[r])){var i=[];for(var s in t[r])i.push(encodeURIComponent(r+"[]")+"="+encodeURIComponent(t[r][s]));n.push(i.join("&"))}else{var u=encodeURIComponent(r),a=r==="id"?o(t[r]):encodeURIComponent(t[r]);n.push(u+"="+a)}return n.join("&")},len:function(t){if(typeof t!="object"&&typeof t.length=="number")return t.length;if(typeof t=="object")return Object.keys(t).length},ByteArray:n,ByteArrayWA:t,bytesFromLatin1:i,latin1FromBytes:s,utf8FromString:function(e){return e?unescape(encodeURIComponent(e)):""},stringFromUtf8:function(e){return e?decodeURIComponent(escape(e)):""},bytesFromHex:function(e){e=e.toLowerCase().replace(/[^0-9a-f]/g,"");var t,n=new Uint8Array(e.length/2);for(var r=0,i=n.length;r<i;r++)t=e.substr(2*r,2),n[r]=parseInt(t,16);return n},hex:r,aToBlob:function(e,t){var n=atob(e);return u.latin1ToBlob(n,t)},latin1ToBlob:function(e,t){return new Blob([u.bytesFromLatin1(e)],{type:t})},random:function(t,n){return Math.random()*(n-t)+t},formatStr:function(n,r){if(typeof r!="object")return e.warn("`params` parameter is not an object"),n;var i;for(i in r)n=n.replace("{"+i+"}",r[i],"g");return n}};return u}()),CoSeMe.namespace("protocol.emitters",function(){"use strict";function e(e){this._tree=e}return e.prototype.getRepresentation=function(){var e=this._tree,t="<"+e.tag,n=e.attributes;if(typeof n=="object")for(var r in n)n.hasOwnProperty(r)&&(t+=" "+r+'="'+e.getAttributeValue(r)+'"');t+=">\n";var i=e.data;i&&(t+=i);var s=e.children;if(Array.isArray(s))for(var o=0,u=s.length;o<u;o++)t+=s[o].toString();return t+="</"+e.tag+">\n",t},e}()),CoSeMe.namespace("protocol",function(){"use strict";function t(e,t){t=t||{},this.tag=e,this.children=t.children||[],this.attributes=t.attributes||{},this._data=t.data||null}var e=CoSeMe.protocol.emitters.XML;return t.tagEquals=function(e,t){return e&&e.tag===t},t.require=function(e,n){if(!t.tagEquals(e,n))throw new Error("Failed require. name: "+n)},t.prototype.toString=function(){var t=new e(this);return t.getRepresentation()},t.prototype.getChild=function(e){var t,n=null,r=this.children;if(r&&r.length>0)if(typeof e=="number"&&e<r.length)n=r[e];else if(typeof e=="string")for(var i=0,s=r.length;i<s&&!n;i++)r[i].tag===e&&(n=r[i]);return n},Object.defineProperty(t.prototype,"tag",{get:function(){var e=this._tag;return e&&e.hexdata&&(e=CryptoJS.enc.Latin1.stringify(CryptoJS.enc.Hex.parse(e.hexdata))),e},set:function(e){this._tag=e}}),Object.defineProperty(t.prototype,"data",{get:function(){var e=this._data;return e&&e.hexdata&&(e=CryptoJS.enc.Latin1.stringify(CryptoJS.enc.Hex.parse(e.hexdata))),e},set:function(e){this._data=e}}),Object.defineProperty(t.prototype,"hexData",{get:function(){return this._data&&this._data.hexdata}}),t.prototype.getAttributeValue=function(e,t){if(!this.attributes)return null;var n=this.attributes
[e];return n&&n.hexdata&&(n=t?n.hexdata:CryptoJS.enc.Latin1.stringify(CryptoJS.enc.Hex.parse(n.hexdata))),typeof n!="undefined"?n:null},t.prototype.getAllChildren=function(e){var t=typeof e!="undefined",n=this.children.filter(function(n){return t||n.tag===e});return n},t}()),CoSeMe.namespace("protocol.dictionary",function(){"use strict";function h(e){var t,n={submap:null,code:null};return i.hasOwnProperty(e)?n.code=i[e]:a.hasOwnProperty(e)&&(t=a[e],n.submap=t[0],n.code=t[1]),n}function p(i,s){var o,u={token:null,submap:null};if(arguments.length===1)i>=n&&i<r?u.submap=i-n:o=e;else{if(s>t.length)throw new Error("Invalid subdictionary: "+s);o=t[s]}if(o){if(i<0||i>=o.length)throw new Error("Invalid token: "+i);if(!o[i])throw new Error("Invalid token or length");u.token=o[i]}return u}var e=["","","","account","ack","action","active","add","after","all","allow","apple","auth","author","available","bad-protocol","bad-request","before","body","broadcast","cancel","category","challenge","chat","clean","code","composing","config","contacts","count","create","creation","debug","default","delete","delivery","delta","deny","digest","dirty","duplicate","elapsed","enable","encoding","error","event","expiration","expired","fail","failure","false","favorites","feature","features","feature-not-implemented","field","first","free","from","g.us","get","google","group","groups","groups_v2","http://etherx.jabber.org/streams","http://jabber.org/protocol/chatstates","ib","id","image","img","index","internal-server-error","ip","iq","item-not-found","item","jabber:iq:last","jabber:iq:privacy","jabber:x:event","jid","kind","last","leave","list","max","mechanism","media","message_acks","message","method","microsoft","missing","modify","mute","name","nokia","none","not-acceptable","not-allowed","not-authorized","notification","notify","off","offline","order","owner","owning","p_o","p_t","paid","participant","participants","participating","paused","picture","pin","ping","platform","port","presence","preview","probe","prop","props","query","raw","read","readreceipts","reason","receipt","relay","remote-server-timeout","remove","request","required","resource-constraint","resource","response","result","retry","rim","s_o","s_t","s.us","s.whatsapp.net","seconds","server-error","server","service-unavailable","set","show","silent","stat","status","stream:error","stream:features","subject","subscribe","success","sync","t","text","timeout","timestamp","to","true","type","unavailable","unsubscribe","uri","url","urn:ietf:params:xml:ns:xmpp-sasl","urn:ietf:params:xml:ns:xmpp-stanzas","urn:ietf:params:xml:ns:xmpp-streams","urn:xmpp:ping","urn:xmpp:whatsapp:account","urn:xmpp:whatsapp:dirty","urn:xmpp:whatsapp:mms","urn:xmpp:whatsapp:push","urn:xmpp:whatsapp","user","user-not-found","value","version","w:g","w:p:r","w:p","w:profile:picture","w","wait","WAUTH-2","xmlns:stream","xmlns","1","chatstate","crypto","phash","enc","class","off_cnt","w:g2","promote","demote","creator","Bell.caf","Boing.caf","Glass.caf","Harp.caf","TimePassing.caf","Tri-tone.caf","Xylophone.caf","background","backoff","chunked","context","full","in","interactive","out","registration","sid","urn:xmpp:whatsapp:sync","flt","s16","u8","adpcm","amrnb","amrwb","mp3","pcm","qcelp","wma","h263","h264","jpeg"],t=[["mpeg4","wmv","audio/3gpp","audio/aac","audio/amr","audio/mp4","audio/mpeg","audio/ogg","audio/qcelp","audio/wav","audio/webm","audio/x-caf","audio/x-ms-wma","image/gif","image/jpeg","image/png","video/3gpp","video/avi","video/mp4","video/mpeg","video/quicktime","video/x-flv","video/x-ms-asf","302","400","401","402","403","404","405","406","407","409","410","500","501","503","504","abitrate","acodec","app_uptime","asampfmt","asampfreq","audio","clear","conflict","conn_no_nna","cost","currency","duration","extend","file","fps","g_notify","g_sound","gcm","gone","google_play","hash","height","invalid","jid-malformed","latitude","lc","lg","live","location","log","longitude","max_groups","max_participants","max_subject","mimetype","mode","napi_version","normalize","orighash","origin","passive","password","played","policy-violation","pop_mean_time","pop_plus_minus","price","pricing","redeem","Replaced by new connection","resume","signature","size","sound","source","system-shutdown","username","vbitrate","vcard","vcodec","video","width","xml-not-well-formed","checkmarks","image_max_edge","image_max_kbytes","image_quality","ka","ka_grow","ka_shrink","newmedia","library","caption","forward","c0","c1","c2","c3","clock_skew","cts","k0","k1","login_rtt","m_id","nna_msg_rtt","nna_no_off_count","nna_offline_ratio","nna_push_rtt","no_nna_con_count","off_msg_rtt","on_msg_rtt","stat_name","sts","suspect_conn","lists","self","qr","web","w:b","recipient","w:stats","forbidden","aurora.m4r","bamboo.m4r","chord.m4r","circles.m4r","complete.m4r","hello.m4r","input.m4r","keys.m4r","note.m4r","popcorn.m4r","pulse.m4r","synth.m4r","filehash","max_list_recipients","en-AU","en-GB","es-MX","pt-PT","zh-Hans","zh-Hant","relayelection","relaylatency","interruption","Apex.m4r","Beacon.m4r","Bulletin.m4r","By The Seaside.m4r","Chimes.m4r","Circuit.m4r","Constellation.m4r","Cosmic.m4r","Crystals.m4r","Hillside.m4r","Illuminate.m4r","Night Owl.m4r","Opening.m4r","Playtime.m4r","Presto.m4r","Radar.m4r","Radiate.m4r","Ripples.m4r","Sencha.m4r","Signal.m4r","Silk.m4r","Slow Rise.m4r","Stargaze.m4r","Summit.m4r","Twinkle.m4r","Uplift.m4r","Waves.m4r","voip","eligible","upgrade","planned","current","future","disable","expire","start","stop","accuracy","speed","bearing","recording","encrypt","key","identity","w:gp2","admin","locked","unlocked","new","battery","archive","adm","plaintext_size","compressed_size","delivered","msg","pkmsg","everyone","v","transport","call-id"]],n=236,r=n+t.length,i={};for(var s,o=0,u=e.length;o<u;o++)s=e[o],s&&(i[s]=o);var a={};for(var f,l=0,u=t.length;l<u;l++){f=t[l];for(var s,o=0,c=f.length;o<c;o++)s=f[o],s&&(a[s]=[l+236,o])}var d=1,v=248,m=249,g=0,y=254,b=252,w=253,E=250
,S=255,x=4,T=3;return{get code2Token(){return p},get token2Code(){return h},get STREAM_START(){return d},get SHORT_LIST_MARK(){return v},get LONG_LIST_MARK(){return m},get EMPTY_LIST_MARK(){return g},get SURROGATE_MARK(){return y},get SHORT_STRING_MARK(){return b},get LONG_STRING_MARK(){return w},get JID_MARK(){return E},get NIBBLE_MARK(){return S},get MAC_LENGTH(){return x},get HEADER_LENGTH(){return T}}}()),CoSeMe.namespace("protocol",function(){"use strict";function o(e){this._socket=e.socket,this.outputKey=undefined}var e=CoSeMe.protocol.dictionary,t=e.token2Code,n=CoSeMe.utils.ByteArrayWA,r=new CoSeMe.common.Logger("BinaryWriter"),i=!0,s=!0,u=e.STREAM_START;o.prototype.streamStart=function(e,t,n){var r=this.newWriteTask(n);r._sendProtocol(i),r._sendProtocol(),r._streamStart(e,t,i),r._streamStart(e,t)},o.prototype._sendProtocol=function(e){var t=5;this.resetBuffer(e,s),this.writeASCII("WA",e),this.writeByte(u,e),this.writeByte(t,e),this.flushBuffer(e)},o.prototype._streamStart=function(e,t,n){var r={to:e,resource:t};this.resetBuffer(n),this.writeListStart(1+2*CoSeMe.utils.len(r),n),this.writeInt8(1,n),this.writeAttributes(r,undefined,n),this.sendMessage(n)},o.prototype.write=function(e,t){var n=this.newWriteTask(t);n._write(e,i),n._write(e)},o.prototype.newWriteTask=function(e){var t=Object.create(this);return t.newWriteTask=undefined,t._callback=e,t._socket=this._socket,t},o.prototype._write=function(e,t){this.resetBuffer(t),e?(this.writeTree(e,t),!t&&r.log(e.toString())):this.writeInt8(0,t),this.sendMessage(t)},o.prototype.writeTree=function(e,t){var n=1+2*CoSeMe.utils.len(e.attributes);e.children.length>0&&n++,e.data!==null&&n++,this.writeListStart(n,t),this.writeString(e.tag,t),this.writeAttributes(e.attributes,e,t),e.data&&this.writeBytes(e.data,t);var r=e.children.length;if(r!==0){this.writeListStart(r,t);for(var i=0;i<r;i++)this.writeTree(e.children[i],t)}};var a=e.SHORT_LIST_MARK,f=e.LONG_LIST_MARK,l=e.EMPTY_LIST_MARK;o.prototype.writeListStart=function(e,t){return e===0?t?this.messageLength++:this.message.write(l):e<256?(t?this.messageLength++:this.message.write(a),this.writeInt8(e,t)):(t?this.messageLength++:this.message.write(f),this.writeInt16(e,t)),this},o.prototype.writeAttributes=function(e,t,n){var r=e||{},i;for(var s in r)r.hasOwnProperty(s)&&(i=t?t.getAttributeValue(s):r[s],this.writeString(s,n),this.writeString(i,n));return this},o.prototype.writeString=function(e,n){typeof e!="string"&&(r.warn("Expecting a string!",typeof e,"given instead."),e===null||e===undefined?e="":e=e.toString());var i=t(e);if(i.code!==null)i.submap!==null&&this.writeToken(i.submap,n),this.writeToken(i.code,n);else if(e.indexOf("@")<1)this.writeBytes(e,n);else{var s=e.split("@"),o=s[0],u=s[1];this.writeJid(o,u,n)}return this};var c=e.SURROGATE_MARK;o.prototype.writeToken=function(e,t){return e<245?t?this.messageLength++:this.message.write(e):e<=500&&(t?this.messageLength++:this.message.write(c),t?this.messageLength++:this.message.write(e-245)),this};var h=e.SHORT_STRING_MARK,p=e.LONG_STRING_MARK;o.prototype.writeBytes=function(e,t){var n;if(typeof e=="string")n=CoSeMe.utils.bytesFromLatin1(e);else if(e instanceof ArrayBuffer)n=new Uint8Array(e);else if(e&&e.buffer instanceof ArrayBuffer)n=new Uint8Array(e.buffer);else{var i=e===null||e===undefined?"":e.toString();r.error("Expecting string, ArrayBuffer or ArrayBufferView-likeobject. A",e.constructor.name,"received instead."),n=CoSeMe.utils.bytesFromLatin1(i)}var s=n.length;s<256?(t?this.messageLength++:this.message.write(h),this.writeInt8(s,t)):(t?this.messageLength++:this.message.write(p),this.writeInt24(s,t));for(var o=0;o<s;o++)t?this.messageLength++:this.message.write(n[o]);return this};var d=e.JID_MARK;o.prototype.writeJid=function(e,t,n){return n?this.messageLength++:this.message.write(d),e?this.writeString(e,n):this.writeToken(0,n),this.writeString(t,n),this},o.prototype.writeASCII=function(e,t){var n;for(var r=0,i=e.length;r<i;r++)n=e.charCodeAt(r),this.writeByte(n,t);return this},o.prototype.writeByte=function(e,t){return this.writeInt8(e,t),this},o.prototype.writeInt8=function(e,t){return t?this.messageLength++:this.message.write(e&255),this},o.prototype.writeInt16=function(e,t){return t?this.messageLength++:this.message.write((e&65280)>>>8),t?this.messageLength++:this.message.write(e&255),this},o.prototype.writeInt24=function(e,t){return t?this.messageLength++:this.message.write((e&16711680)>>>16),t?this.messageLength++:this.message.write((e&65280)>>>8),t?this.messageLength++:this.message.write(e&255),this},o.prototype.sendMessage=function(e){if(e)return;this.isEncrypted()&&this.cipherMessage(),this.addMessageHeader(),this.flushBuffer(e)},o.prototype.flushBuffer=function(e){if(e)return;try{var t,i,s;if(this.isRaw)t=this.message.finish().buffer,i=0,s=this.messageLength;else{var o=new Uint32Array(this.outBuffer),u=o.buffer.byteLength;t=(new n(o,u)).finish().buffer,i=m,s=v+this.messageLength}var a=null,f=this._socket.readyState;f==="open"?this._socket.send(t.buffer,i,s):(r.warn("Can not write. Socket state:",f),a="socket-non-ready"),typeof this._callback=="function"&&this._callback(a)}catch(l){var f=this._socket.readyState;typeof this._callback=="function"&&this._callback(f==="closed"?"disconnected":l)}};var v=e.HEADER_LENGTH,m=4-v%4,g=v+m,y=e.MAC_LENGTH;return o.prototype.resetBuffer=function(e,t){if(e)this.messageLength=0;else{this.isRaw=t;if(t)this.message=new n(this.messageLength);else{var r=this.isEncrypted()?y:0;this.messageLength+=r,this.messagePadding=4-this.messageLength%4,this.completeMessageLength=this.messageLength+this.messagePadding;var i=g+this.completeMessageLength;this.outBuffer=(new Uint8Array(i)).buffer;var s=new Uint32Array(this.outBuffer,0,g>>>2),o=new Uint32Array(this.outBuffer,g);this.header=new n(s),this.message=new n(o)}}},o.prototype.cipherMessage=function(){var e=this.outputKey.encodeMessage(this.message);for(var t=0;t<y;t++)this.message.write(e.hmacSHA1.get(t))},o.prototype.addMessageHeader=function(){for(var e=0
;e<m;e++)this.header.write(0);var t=this.messageLength,n=this.isEncrypted()?128:0,r=n|(t&16711680)>>>16,i=(t&65280)>>>8,s=t&255;this.header.write(r),this.header.write(i),this.header.write(s)},o.prototype.isEncrypted=function(){return!!this.outputKey},o}()),CoSeMe.namespace("protocol",function(){"use strict";function s(){this.incoming=[],this.incomingCount=0,this.incomingOffset={chunk:0,"byte":0},this.partialConsumed=0,this.inputKey=null}var e=CoSeMe.protocol.dictionary,t=e.code2Token,n=CoSeMe.utils.ByteArrayWA,r=CoSeMe.protocol.Tree,i=new CoSeMe.common.Logger("BinaryReader"),o=e.STREAM_START;s.prototype.startListening=function(e){this.socket=e.socket,this.isStreamStartRead=!1,this.paused=!1;var t=this;this.socket.ondata=function(e){var n=navigator.requestWakeLock("cpu");t.onSocketData(e.data),n.unlock()}},s.prototype.pendingTrees=[],s.prototype.suspend=function(){if(this.paused)return;this.socket.suspend(),this.paused=!0},s.prototype.resume=function(){if(!this.paused)return;this.socket.resume(),this.paused=!1,this.attendPendingTrees()},s.prototype.onSocketData=function(e){i.log("Received socket data:",e.byteLength,"bytes!"),e&&this.addDataChunk(e),this.checkForAnotherTree()},s.prototype.checkForAnotherTree=function(){while(!this.waitingForMessage())this.isStreamStartRead?this.readNextTree():(this.readStreamStart(),this.isStreamStartRead=!0)},s.prototype.readStreamStart=function(){var e=this.newReaderTask();e._readStreamStart()},s.prototype.readNextTree=function(){var e=this.newReaderTask();e._readNextTree()},s.prototype.newReaderTask=function(){var e=Object.create(this);return this.readStanza(),e.startListening=undefined,e.suspend=undefined,e.resume=undefined,e.newReaderTask=undefined,e.mac=this.mac,e.message=this.message,e.stanzaSize=this.stanzaSize,e.isEncrypted=this.isEncrypted,e.sourceSocket=this.socket,this.finishReading(),e},s.prototype._readStreamStart=function(){var e=this.message.read(),t=this.readListSize(e),n,s=this.message.read(),u=null;if(s===o){var a=(t-2+t%2)/2;n=new r("start",{attributes:this.readAttributes(a)})}else u=new Error("Expecting STREAM_START"),i.error(u);this.dispatchResult(u,n,"onStreamStart")},s.prototype._readNextTree=function(){var e=null,t;try{t=this.readTree(),i.log(t?t.toString():t+"")}catch(n){e=n,t=undefined,i.error(n)}this.dispatchResult(e,t,"onTree")},s.prototype.dispatchResult=function(e,t,n){this.pendingTrees.push([e,t,n]),this.paused||this.attendPendingTrees()},s.prototype.attendPendingTrees=function(){var e,t,n,r,i,s=Object.getPrototypeOf(this).socket;while(e=this.pendingTrees.shift())t=e[0],n=e[1],r=e[2],i=navigator.requestWakeLock("cpu"),setTimeout(function(t,n,r,i){if(this.sourceSocket===s){var o=this[t];typeof o=="function"&&o(n,r)}i.unlock()}.bind(this,r,t,n,i))},s.prototype.finishReading=function(){this.freeIncoming(),this.mac=null,this.message=null,this.isEncrypted=undefined,this.stanzaSize=undefined},s.prototype.freeIncoming=function(){var e,t=0,n=this.incomingOffset,r=n.chunk;for(var i=0;i<r;i++)e=this.incoming.shift(),t+=e.length;t+=n.byte-this.partialConsumed,this.partialConsumed=n.byte,n.chunk=0,this.incomingCount-=t},s.prototype.addDataChunk=function(e){var t=new Uint8Array(e);this.incoming[this.incoming.length]=t,this.incomingCount+=t.length};var u=e.HEADER_LENGTH;s.prototype.waitingForMessage=function(){if(this.stanzaSize===undefined){if(this.incomingCount<u)return!0;var e=this.readIncoming(),t=this.readIncoming(),n=this.readIncoming();this.stanzaSize=((e&15)<<16)+(t<<8)+n,this.isEncrypted=!!(e&128)}return this.incomingCount<u+this.stanzaSize},s.prototype.readIncoming=function(){var e=this.incomingOffset,t=e.byte,n=e.chunk,r=this.incoming[n],i=r[t];return t++,t===r.length&&(this.partialConsumed&&(this.incoming[n]=new Uint8Array(this.incoming[n].buffer,this.partialConsumed)),n++,t=0,this.partialConsumed=0),e.byte=t,e.chunk=n,i},s.prototype.readStanza=function(){this.fillMessageBuffer();var e=this.isEncrypted;if(e&&!this.inputKey)throw new Error("The messages are ciphered but there is no key to decipher.");e&&this.decipherMessage()};var a=e.MAC_LENGTH;s.prototype.fillMessageBuffer=function(){var e=this.stanzaSize;this.isEncrypted&&(e-=a),this.message=new n(e);for(var t=0;t<e;t++)this.message.write(this.readIncoming());if(this.isEncrypted){this.mac=new n(a);for(var t=0;t<a;t++)this.mac.write(this.readIncoming())}},s.prototype.decipherMessage=function(){this.message=this.inputKey.decodeMessage(this.message,this.mac)},s.prototype.readTree=function(){var e=this.message.read(),t=this.readListSize(e),n=this.message.read();if(n===2)return null;var i=this.readString(n);if(t===0||i===null)throw new SyntaxError("0 list or null tag!");var s=(t-2+t%2)/2,o=this.readAttributes(s);if(t%2===1)return new r(i,{attributes:o});var u=this.message.read();return this.isListMark(u)?new r(i,{attributes:o,children:this.readList(u)}):(n=u,new r(i,{attributes:o,data:this.readString(n)}))},s.prototype.readList=function(e){var t=this.readListSize(e),n=[];for(var r=0;r<t;r++)n.push(this.readTree());return n},s.prototype.isListMark=function(e){return e==f||e==l||e==c},s.prototype.readInt8=function(){return this.message.read()},s.prototype.readInt16=function(){var e=this.message.read(),t=this.message.read();return e!==undefined&&t!==undefined?(e<<8)+t:undefined},s.prototype.readInt24=function(){var e=this.message.read(),t=this.message.read(),n=this.message.read();return e!==undefined&&t!==undefined&&n!==undefined?(e<<16)+(t<<8)+n:undefined},s.prototype.readNibble=function(){var e=["0","1","2","3","4","5","6","7","8","9","-","."],t=this.message.read(),n=(t&128)!=0,r=t&127,i=r*2-n,s=new Uint8Array(r);this.fillArray(s,r);var o=[],u;for(var a=0,f=s.length;a<f;a++){t=s[a];var l=Number(s[a])>>4;if(!(l<=11))throw new SyntaxError("Bad nibble "+l);o.push(e[l]);if(a!=f-1||!n){var l=Number(s[a])&15;if(!(l<=11))throw new SyntaxError("Bad nibble "+l);o.push(e[l])}}return o.join("")};var f=e.SHORT_LIST_MARK,l=e.LONG_LIST_MARK,c=e.EMPTY_LIST_MARK;s.prototype.readListSize=function(e
){var t;switch(e){case c:t=0;break;case f:t=this.readInt8();break;case l:t=this.readInt16();break;default:var n="Invalid list size: sizeMark = "+e;throw new SyntaxError(n)}return t},s.prototype.readAttributes=function(e){var t,n,r={};while(e>0)t=this.readString(this.message.read()),n=this.readString(this.message.read()),r[t]=n,e--;return r};var h=e.SHORT_STRING_MARK,p=e.LONG_STRING_MARK,d=e.SURROGATE_MARK,v=e.JID_MARK,m=e.NIBBLE_MARK;return s.prototype.readString=function(e,t){var n=null;if(e===0)n="";else if(e>2&&e<245){var r=e;n=this.getToken(r)}else if(e===d){var r=this.message.read();n=this.getToken(r+245)}else if(e===h){var i=this.readInt8(),s=new Uint8Array(i);this.fillArray(s,i),n={hexdata:this.bufferToString(s)}}else if(e===p){var i=this.readInt24(),s=new Uint8Array(i);this.fillArray(s,i),n={hexdata:this.bufferToString(s)}}else if(e===v){var o=this.readString(this.message.read(),!0),u=this.readString(this.message.read(),!0);if(o&&u)n=o+"@"+u;else{if(!u)throw new SyntaxError("could not reconstruct JID.");n=u}}else{if(e!==m)throw new SyntaxError("could not find a string.");n=this.readNibble()}return t&&n&&n.hexdata&&(n=CryptoJS.enc.Latin1.stringify(CryptoJS.enc.Hex.parse(n.hexdata))),n},s.prototype.getToken=function(e){var n=t(e);return n.token===null&&(e=this.readInt8(),n=t(e,n.submap)),n.token},s.prototype.fillArray=function(e,t){for(var n=0;n<t;n++)e[n]=this.message.read()},s.prototype.bufferToString=function(e){var t=[],n;for(var r=0,i=e.length;r<i;r++)n=Number(e[r]).toString(16),e[r]<16&&(n="0"+n),t.push(n);return t.join("")},s}()),CoSeMe.namespace("http",function(){"use strict";var e=new CoSeMe.common.Logger("http");return{doRequest:function(n,r,i,s){var o="https://v.whatsapp.net/v2/"+n+"?"+CoSeMe.utils.urlencode(r);e.log("Request:",o);var u=new XMLHttpRequest({mozSystem:!0});u.onload=function(){e.log(this.response),i&&i.call(this,this.response)},u.onerror=s,u.open("GET",o),u.overrideMimeType("json"),u.responseType="json",u.setRequestHeader("User-Agent",CoSeMe.config.tokenData.u),u.setRequestHeader("Accept","text/json"),u.send()},doContactsRequest:function(n,r,i,s){var o=new XMLHttpRequest({mozSystem:!0});o.onload=function(){i&&i.call(this,this.response)},o.onerror=s,r?o.open(CoSeMe.config.contacts.method,CoSeMe.config.contacts.url_query):o.open(CoSeMe.config.contacts.method,CoSeMe.config.contacts.url_auth),o.overrideMimeType("json"),o.responseType="json",o.setRequestHeader("User-Agent",CoSeMe.config.tokenData.u),o.setRequestHeader("Authorization",n),o.setRequestHeader("Accept","text/json");if(r){var u=CoSeMe.utils.urlencode(r);e.log("Contact request parameters:",u),o.send(u)}else o.send()}}}()),CoSeMe.namespace("registration",function(){"use strict";function e(e){var t="PdA2DJyKoUrwLw1Bg6EIhzh502dF9noR9uFCllGk1447796090073"+e,n=CryptoJS.enc.Latin1.parse(t),r=CryptoJS.MD5(n);return r.toString()}function t(e){var t=e||(Math.random()*1e16).toString(36).substring(2,10),n=CryptoJS.SHA1(t).toString(CryptoJS.enc.Latin1).substring(0,20);return{seed:t,id:n}}function n(e,t,n){return n=n||"0",e+="",e.length>=t?e:(new Array(t-e.length+1)).join(n)+e}return{getCode:function(r,i,s,o,u,a,f,l,c){var h=Object.create(null);h.cc=r,h["in"]=i,h.lc=l.split("-")[1]||"GB",h.lg=l.split("-")[0]||"en",h.sim_mcc=n(a,3),h.sim_mnc=n(f,3),h.method=c in{sms:1,voice:1}?c:"sms",h.token=e(i);var p=t(u);return h.id=p.id,this.exists(r,i,p.id,function(t){t&&t.status==="ok"?s(t):CoSeMe.http.doRequest("code",h,s,o)},o),p.seed},exists:function(t,n,r,i,s){var o=Object.create(null);o.cc=t,o["in"]=n,o.id=r,o.lg="en",o.lc="GB",o.token=e(n),CoSeMe.http.doRequest("exist",o,i,s)},register:function(e,n,r,i,s,o){var u=Object.create(null);u.cc=e,u["in"]=n,u.code=r;var a=t(o);return u.id=a.id,CoSeMe.http.doRequest("register",u,i,s),a.id}}}()),CoSeMe.namespace("media",function(){"use strict";function t(t,n,r,i){var s=null,o=new XMLHttpRequest({mozSystem:!0});o.open("GET",t,!0),o.responseType="blob",o.setRequestHeader("User-Agent",CoSeMe.config.tokenData.u),o.onprogress=function(t){e.log("XHR fired onprogress...");if(i&&t.lengthComputable){var n=Math.floor(t.loaded/t.total*100);i(n)}},o.onload=function(){e.log("XHR fired onload. xhr.status:",o.status),o.status===200||o.status===0?(s=o.response,n&&n(s)):r&&r(o.status)},o.onerror=function(e){r&&r(o.status)},o.send()}function n(t,n,r,i,s,o,u){function h(e,i){var s=new FormData;s.append("to",t),s.append("from",CoSeMe.yowsup.connectionmanager.jid.replace("@whatsapp.net","")),s.append("file",n,e),c.open("POST",r),c.responseType="json",c.setRequestHeader("User-Agent",CoSeMe.config.tokenData.u),c.send(s)}var a=n.size,f=n.type;e.log("size:",a,"filetype:",f);var l=new FileReader;l.addEventListener("loadend",function(){var t=l.result;u=typeof u=="undefined"?t.byteLength:Math.min(u,t.byteLength);var n=CoSeMe.crypto.MD5_IP(t.slice(0,u)),r=n+"."+f.split("/")[1];e.log("MD5+ext:",r),h(r,l.result)}),l.readAsArrayBuffer(n);var c=new XMLHttpRequest({mozSystem:!0});c.upload.onprogress=function(t){e.log("XHR fired onprogress...");if(o&&t.lengthComputable){var n=Math.floor(t.loaded/t.total*100);o(n)}},c.onload=function(t){e.log("XHR fired onload. xhr.status:",c.status);if(c.status===200){o&&o(100);var n=c.response;n.url?(e.log("We got an URL on the result:",n.url),i&&i(n.url)):s&&s("No URL in result")}else e.log("Got error status:",c.status),s&&s(c.status)},c.onerror=function(e){s&&s(c.status)}}var e=new CoSeMe.common.Logger("media");return{download:t,upload:n}}()),CoSeMe.namespace("connection",function(){"use strict";function t(){return e||(e=Object.create(t.prototype)),e}function n(){e.socket.onerror=r("onconnectionlost"),e.socket.onclose=r("onconnectionclosed")}function r(t){return function(){var n=e[t];typeof n=="function"&&n.apply(e,arguments)}}function i(){e.reader=new CoSeMe.protocol.BinaryReader(e),e.writer=new CoSeMe.protocol.BinaryWriter(e)}var e;return t.prototype.connect=function(t,r,s,o,u){s=s||{};var a=navigator.mozTCPSocket.open(t,r,s);a.onerror=function(){u&&u("connection-refused")},a.
onopen=function(){e.socket=a,n(),i(),o&&o.apply(this,arguments)}},t}()),CoSeMe.namespace("time",function(){"use strict";function e(e){return new Date(e)}function t(e){return e}function n(){return Math.floor(Date.now()/1e3)}function r(e){return Math.floor(e.getTime()/1e3)}return{parseIso:e,utcToLocal:t,utcTimestamp:n,datetimeToTimestamp:r}}()),CoSeMe.namespace("auth",function(){"use strict";function c(e,t){var n="",r=e+"";return r.length<t&&(n=(new Array(t-r.length+1)).join("0")),n+r}function h(e,t,n,o,u){n=c(n,3),o=c(o,3),r=e,i=t,s=u,p(function(t,u){if(t)return s(t);a=u,d(function(t){if(t==="one-shot-rejected"){h(r,i,n,o,s);return}if(t)return s(t);l=!0,a.reader.suspend(),a.reader.onStreamStart=undefined,a.reader.onTree=undefined,a.writer.outputKey=f,a.jid=r+"@"+CoSeMe.config.domain,s(null,a)})})}function p(t){function o(){t&&t(null,n)}function u(){t&&t("connection-refused")}var n=new CoSeMe.connection.Connection,r=CoSeMe.config.auth.host,i=CoSeMe.config.auth.port,s=CoSeMe.config.auth.connectionOptions;e.log("Connecting to:",r+":"+i),n.connect(r,i,s,o,u)}function d(t){e.log("Starting login...");var n=CoSeMe.config.domain,r=CoSeMe.config.tokenData.r;e.log("Sending stream start, features & authentication"),a.writer.streamStart(n,r),a.writer.write(g()),a.writer.write(y(w())),v(function(r){if(r)switch(r){case"one-shot-rejected":case"auth-failed":case"expired":return t(r);default:return e.error("<stream:error>",r),t(r)}t(null)})}function v(t){function r(r,i){function o(e){var t=m(e),r=new n("response",{data:t});a.writer.write(r)}function u(){if(w()!==null)return e.log("Looks like the one-shot challenge failed.Trying with no-challenge."),E(null),t("one-shot-rejected");e.log("Authentication failed!"),t("auth-failed")}function f(n){if(n.getAttributeValue("status")==="expired")return e.warn("The accound has expired."),t("expired");e.log("Authentication success!");var r=n.getAttributeValue("expiration");r=parseInt(r,10),isNaN(r)||(a.expiration=new Date(r*1e3)),E(n.data),t(null)}if(r)return t(r);if(!i)return;switch(i.tag){case"stream:error":var s=i.getChild("text").data;e.error(s),t(s);break;case"start":e.log("Got stream start! Waiting for challenge...");break;case"stream:features":e.log("Got the features.");break;case"challenge":e.log("Got the challenge! Sending answer..."),o(i.data);break;case"failure":u();break;case"success":f(i);break;default:e.warn("Unexpected auth tree: ",i.tag)}}e.log("Waiting for stream start..."),a.reader.onStreamStart=r,a.reader.onTree=r,a.reader.startListening(a)}function m(e){var n=CoSeMe.auth.KeyStream.getKeys(i,e);a.reader.inputKey=new CoSeMe.auth.KeyStream(n.inputKey,n.inputHMAC,"input"),f=new CoSeMe.auth.KeyStream(n.outputKey,n.outputHMAC,"output");var s=CryptoJS.enc.Latin1.parse(CoSeMe.time.utcTimestamp()+""),l=CryptoJS.enc.Latin1.parse(r);l.concat(CryptoJS.enc.Latin1.parse(e)),l.concat(s),l.concat(CryptoJS.enc.Latin1.parse(CoSeMe.config.tokenData.u)),l.concat(CryptoJS.enc.Latin1.parse(" MccMnc/"+u+o));var c=(new t(l.sigBytes)).writeAll(l),h=f.encodeMessage(c),p=CoSeMe.config.auth.hmacLength,d=new t(p+h.text.array.sigBytes);for(var v=0;v<p;v++)d.write(h.hmacSHA1.get(v));return CryptoJS.enc.Latin1.stringify(d.writeAll(h.text.array).array)}function g(){var e=[new n("readreceipts"),new n("groups_v2"),new n("privacy"),new n("presence")];return new n("stream:features",{children:e})}function y(t){var i="";return t&&(e.log("There is a existing challenge, trying one-shot auth!"),i=m(t)),new n("auth",{attributes:{mechanism:"WAUTH-2",user:r},data:i})}function w(){return localStorage.getItem(b)}function E(e){e===null?localStorage.removeItem(b):localStorage.setItem(b,e)}var e=new CoSeMe.common.Logger("auth"),t=CoSeMe.utils.ByteArrayWA,n=CoSeMe.protocol.Tree,r,i,s,o,u,a,f,l=!1,b="__cosemeNextChallenge";return{authenticate:h,get isAuthenticated(){return l}}}()),CoSeMe.namespace("auth",function(){function n(e,t,n){this.sequence=0,this.name=n,this.key=e,this.macKey=t,this.encryptor=CryptoJS.algo.RC4WP.createEncryptor(this.key,CoSeMe.config.auth.rc4Options)}var e=new CoSeMe.common.Logger("KeyStream"),t=CoSeMe.utils.ByteArrayWA;return n.getKeys=function(t,n){try{e.log("nonce (latin1):",n),e.log("password (base64):",t),t=CryptoJS.enc.Base64.parse(t);var r={outputKey:"",outputHMAC:"",inputKey:"",inputHMAC:""},i={};return Object.keys(r).forEach(function(s){var o=r[s],u=CryptoJS.enc.Latin1.parse(n+o),a=CryptoJS.PBKDF2(t,u,CoSeMe.config.auth.pbkdf2Options);i[s]=a}),e.log("Keys:",i),i}catch(s){return e.error(s),null}},n.prototype.decodeMessage=function(t,n){var r=this.computeMac(t).toString(CryptoJS.enc.Hex),i=CryptoJS.enc.Hex.stringify(n.array);if(i!==r.substring(0,i.length))throw e.error("INVALID MAC!"),new Error("Invalid MAC");var s=t.array,o=this.encryptor.finalize(s);return t},n.prototype.encodeMessage=function(e){var n=e.array;this.encryptor.finalize(n);var r=this.computeMac(e);return{text:e,hmacSHA1:(new t(r.sigBytes)).writeAll(r)}},n.prototype.computeMac=function(e){e.write(this.sequence,4);var t=CryptoJS.HmacSHA1_IP(e.array,this.macKey);return e.rewind(4),this.sequence++,t},n}()),CoSeMe.namespace("yowsup",function(){"use strict";function r(e,t){e in CoSeMe.yowsup.connectionmanager.signals&&CoSeMe.yowsup.connectionmanager.signals[e].push(t)}function i(e,t){try{return CoSeMe.yowsup.connectionmanager.methods[e].apply(undefined,t)}catch(r){throw n.error("Error invoking",e,"with",t),n.error("Error details:",r),r}}function s(){return{registerListener:r}}function o(){return{call:i,registerCallback:function(e,t){CoSeMe.yowsup.connectionmanager.methods[e]=t}}}var e=CoSeMe.utils.stringFromUtf8,t=CoSeMe.utils.utf8FromString,n=new CoSeMe.common.Logger("yowsupAPI");return{getSignalsInterface:s,getMethodsInterface:o}}()),CoSeMe.namespace("yowsup.readerThread",function(){"use strict";function l(e){var t={},n={};e.forEach(function(e){var r=e.getAttributeValue("name");r&&(t[r]=e.getAttributeValue("value"),n[r]||(t[r]=parseInt(t[r],10)))}),u.send("got_properties",[t])}function c(e){var t=e.data;
n.error("Socket error due to:",e,"!"),u.send("disconnected",[t])}function h(t,r){try{if(a.tagEquals(r,"iq")){var i=r.getAttributeValue("type"),s=r.getAttributeValue("id")||"";if(!i||!f[i]){var o="Invalid or missing iq type: "+i;throw o}f[i](i,s,r)}else if(a.tagEquals(r,"presence")){var l=r.getAttributeValue("xmlns"),c=r.getAttributeValue("from");if(!l||l=="urn:xmpp"&&c){var h=r.getAttributeValue("type");if(h=="unavailable"){var d=r.getAttributeValue("last");u.send("presence_unavailable",[c,d&&parseInt(d,10)])}else(!h||h=="available")&&u.send("presence_available",[c])}else if(l=="w"&&c){var v=e(r.getAttributeValue("status"));v=="dirty"&&(n.log("Will send DIRTY"),u.send("status_dirty"),n.log("DIRTY sent"))}}else if(a.tagEquals(r,"message"))p(r);else{if(a.tagEquals(r,"receipt")){var m=r.getAttributeValue("to"),g=r.getAttributeValue("from"),y=r.getAttributeValue("id"),b=r.getAttributeValue("type"),w=r.getAttributeValue("participant");if(!g||!y){n.error("Malformed receipt, can not determine the origin.");return}var E=[g,y,b,w,m];if(g=="s.us"){u.send("profile_setStatusSuccess",["s.us",y]);return}u.send("receipt_messageDelivered",E);return}if(a.tagEquals(r,"chatstate")){var S=r.getAttributeValue("from"),x;r.getChild("composing")?x="contact_typing":r.getChild("paused")&&(x="contact_paused"),u.send(x,[S])}else if(a.tagEquals(r,"ack")){var T=r.getAttributeValue("class"),S=r.getAttributeValue("from"),N=r.getAttributeValue("id");T==="message"&&S&&u.send("receipt_messageSent",[S,N])}else if(a.tagEquals(r,"notification")){var b=r.getAttributeValue("type"),S=r.getAttributeValue("from"),C=parseInt(r.getAttributeValue("t"),10),y=r.getAttributeValue("id");if(b==="participant"){var k="notification_groupParticipant",L=r.getChild(0).tag,c=r.getChild(0).getAttributeValue("jid");L==="add"?k+="Added":L==="remove"?k+="Removed":console.error("Participant notification not understood"),u.send(k,[S,c,null,C,y,null])}else if(b==="w:gp2"){var k="notification_group",L=r.getChild(0).tag;if(L==="add"){k+="ParticipantAdded";var c=r.getChild(0).getChild(0).getAttributeValue("jid");u.send(k,[S,c,null,C,y,null])}else if(L==="create"){k+="Created";var A=r.getAttributeValue("notify"),O=r.getAttributeValue("participant"),M=r.getChild(0).getChild(0),_=e(M.getAttributeValue("subject"));u.send(k,[S,C,y,_,A,O])}else if(L==="remove"){k+="ParticipantRemoved";var c=r.getChild(0).getChild(0).getAttributeValue("jid");u.send(k,[S,c,null,C,y,null])}else if(L==="subject"){k+="SubjectUpdated";var A=r.getAttributeValue("notify"),O=r.getAttributeValue("participant"),M=r.getChild(0),_=e(M.getAttributeValue("subject"));u.send(k,[S,C,y,_,A,O])}else u.onUnknownNotification(S,y,b)}else if(b==="picture"){var D=S.indexOf("-")>=0?"group":"contactProfile",k="notification_"+D+"Picture",L=r.getChild(0).tag,P=r.getChild(0).getAttributeValue("id"),O=r.getChild(0).getAttributeValue("author");L==="set"?k+="Updated":L==="delete"?k+="Removed":console.error("Picture notification not understood"),u.send(k,[S,C,y,P,O])}else if(b==="subject"){var A=r.getAttributeValue("notify"),k="notification_group",M=r.getChild(0),O=r.getAttributeValue("participant");k+=M.getAttributeValue("event")==="add"?"Created":"SubjectUpdated";var _=e(M.data);u.send(k,[S,C,y,_,A,O])}else if(b==="status"){var M=r.getChild(0),v=e(M.data);u.send("notification_status",[S,y,v])}else u.onUnknownNotification(S,y,b)}}}catch(H){n.error(H)}}function p(t){function g(t){var r=t.getAttributeValue("url"),i=t.getAttributeValue("type"),s=t.getAttributeValue("size"),a=t.getAttributeValue("encoding"),v=t.data,m=!0,g={image:function(e){f?u.send("group_imageReceived",[d,c,h,v,r,s,m,p,o]):u.send("image_received",[d,c,v,r,s,m,l,p,o])},video:function(e){f?u.send("group_videoReceived",[d,c,h,v,r,s,m,p,o]):u.send("video_received",[d,c,v,r,s,m,l,p,o])},audio:function(e){f?u.send("group_audioReceived",[d,c,h,r,s,m,p,o]):u.send("audio_received",[d,c,r,s,m,l,p,o])},location:function(t){n.log("Location Childnode:",t);var r=t.getAttributeValue("latitude"),i=t.getAttributeValue("longitude"),s=e(t.getAttributeValue("name"))||"";f?u.send("group_locationReceived",[d,c,h,s,v,r,i,m,p,o]):u.send("location_received",[d,c,s,v,r,i,m,l,p,o])},vcard:function(t){n.log("VCARD:",t);var r=t.getChild("vcard").toString(),i=e(t.getChild("vcard").getAttributeValue("name"));if(r){var s=r.indexOf(">")+1;r=r.substr(s,r.length-s),r=r.replace("</vcard>",""),f?u.send("group_vcardReceived",[d,c,h,i,r,m,p,o]):u.send("vcard_received",[d,c,i,r,m,l,p,o])}}};a=="raw"&&v&&(v=CryptoJS.enc.Base64.stringify(CryptoJS.enc.Latin1.parse(v)));try{g[i](t)}catch(y){n.error("Unknown media type!",y);return}}function y(t){var n,r,i,s;if(a.tagEquals(t,"request"))m=!0;else if(a.tagEquals(t,"notify"))n=e(t.getAttributeValue("name"));else if(a.tagEquals(t,"delay"))i=t.getAttributeValue("xmlns"),"urn:xmpp:delay"==i&&(r=t.getAttributeValue("stamp"),r&&(s=r,o=self.parseOfflineMessageStamp(s)*1e3));else if(a.tagEquals(t,"x")){i=t.getAttributeValue("xmlns");if("jabber:x:event"==i&&d)c=="broadcast"&&u.send("receipt_broadcastSent",[d]);else if("jabber:x:delay"==i)return}else if(a.tagEquals(t,"delay")||!a.tagEquals(t,"received")||!d){return;var f}}function b(e){a.tagEquals(e,"request")?m=!0:a.tagEquals(e,"broadcast")?l=!0:a.tagEquals(e,"media")&&d?(n.log("Multimedia message!"),g(e)):a.tagEquals(e,"body")&&d?s=e.data:a.tagEquals(e,"enc")?u.onEncryptedMessage(c,d):a.tagEquals(e,"active")||y(e)}var r=t.getChild("body"),i=r?e(r.data):"",s=null,o=Number(t.getAttributeValue("t")).valueOf(),f=!1,l=!1,c=t.getAttributeValue("from"),h=t.getAttributeValue("participant"),p=t.getAttributeValue("notify"),d=t.getAttributeValue("id"),v=t.getAttributeValue("type"),m=!1;p=p&&e(p),n.log("Parsing message:",t);var w={error:function(){var e=t.getAllChildren("error");e.forEach(function(e){var t=e.getAttributeValue("code"),n=Number(t).valueOf();u.send("message_error",[data.msgId,data.fromAttribute,n])})},subject:function(){var e=!1,n=t.getAllChildren("request");e=n.some(function(e){return e.getAttributeValue
("xmlns")=="urn:xmpp:receipts"}),i&&u.send("group_subjectReceived",[d,c,h,i,o,e])},text:function(){m=!1;var e=t.children||[];e.forEach(b)},media:function(){m=!0;var e=t.children||[];e.forEach(b)}};if(i.contains("New version of WhatsApp Messenger is now available")){n.log("Rejecting server message");return}c.contains("-")&&(f=!0);try{w[v]()}catch(E){throw n.error(E),new Error("Unknown type of message:"+v+"!")}s&&(s=e(s),m=!0,f?u.send("group_messageReceived",[d,c,h,s,o,m,p]):u.send("message_received",[d,c,s,o,m,p,l]))}function d(e){var t=e.getAttributeValue("id");this.lastPongTime=Date.now()}function v(t){var n=t.getAttributeValue("from"),r=t.getChild(0);if(r.toString().contains("error code"))u.send("group_infoError",[0]);else{a.require(r,"group");var i=r.getAttributeValue("owner"),s=e(r.getAttributeValue("subject")),o=r.getAttributeValue("s_t"),f=r.getAttributeValue("s_o"),l=r.getAttributeValue("creation"),c=r.children.map(function(e){return e.getAttributeValue("jid")});u.send("group_gotInfo",[n,i,s,f,o,l,c])}}function m(t){var n=[],r=t.getAttributeValue("id");t.children[0].children.forEach(function(t){n.push({gid:t.getAttributeValue("id"),owner:t.getAttributeValue("owner"),subject:e(t.getAttributeValue("subject")),subjectT:t.getAttributeValue("s_t"),subjectOwner:t.getAttributeValue("s_o"),creation:t.getAttributeValue("creation"),participants:t.children.map(function(e){return e.getAttributeValue("jid")})})}),u.send("group_gotParticipating",[n,r])}function g(e){var t=e.getAttributeValue("from"),n=t.contains("-");if(e.getAttributeValue("type")==="error"){u.send(n?"group_gotPicture":"contact_gotProfilePicture",[t,null,null]);return}var r=e.getChild("picture");if(r){var i=CoSeMe.utils.latin1ToBlob(r.data,"image/jpeg"),s=Number(r.getAttributeValue("id")).valueOf();n?u.send("group_gotPicture",[t,s,i]):u.send("contact_gotProfilePicture",[t,s,i])}}function y(e){var t=e.getAttributeValue("id");if(e.getAttributeValue("type")==="error"){var n=e.getChild(0).getAttributeValue("code");u.send("group_createFail",[n,t])}else{var r=e.getChild(0);a.require(r,"group");var i=r.getAttributeValue("id");u.send("group_createSuccess",[i+"@g.us",t])}}function b(e){var t=e.getAttributeValue("from"),n=[],r,i,s=e.getAllChildren("add");for(var o=0,a=s.length;o<a;o++)i=s[o],i.tagName==="participant"&&n.push(i.getAttributeValue("jid"));u.send("group_addParticipantsSuccess",[t,n])}function w(e){var t=e.getAttributeValue("from"),n=[],r,i,s=e.getAllChildren("remove");for(var o=0,a=s.length;o<a;o++)i=s[o],i.tagName==="participant"&&n.push(i.getAttributeValue("jid"));u.send("group_removeParticipantsSuccess",[t,n])}function E(e){var t=e.getAttributeValue("id"),n=e.getAttributeValue("from"),r=n.indexOf("-")>=0?"group":"profile",i=e.getChild("picture"),s;e.getAttributeValue("type")==="error"?u.send(r+"_setPictureError",[0,t]):(s=parseInt(i.getAttributeValue("id"),10),u.send(r+"_setPictureSuccess",[s,t]))}function S(e){var t=e.getChild(0),n=t.getChild(0),r=n.getAttributeValue("id");u.send("group_endSuccess",[r])}function x(e){var t=e.getAttributeValue("from");u.send("group_setSubjectSuccess",[t])}function T(e){var t,n=e.getAllChildren("group"),r,i,s,o,a,f;for(var l=0,c=n.length;l<c;l++)t=n[l],r=t.getAttributeValue("id")+"@g.us",i=t.getAttributeValue("owner"),s=t.getAttributeValue("subject"),o=t.getAttributeValue("s_t"),a=t.getAttributeValue("s_o"),f=t.getAttributeValue("creation"),u.send("group_gotInfo",[r,i,s,a,parseInt(o,10),parseInt(f)])}function N(e){var t=e.getAttributeValue("from"),n=e.getAllChildren("participant"),r,i=[];for(var s=0,o=n.length;s<o;s++)r=n[s],i.push(r.getAttributeValue("jid"));u.send("group_gotParticipants",[t,i])}function C(e){var t=e.getAttributeValue("from"),r=e.getChild(0);if(r.toString().indexOf("error")>=0)return;a.require(r,"query");var i=r.getAttributeValue("seconds");i!==null&&t!==null?(i=parseInt(r.getAttributeValue("seconds"),10),u.send("presence_updated",[t,i])):n.error("Malformed query result!")}function k(e){var t=e.getChild("sync")&&e.getChild("sync").getChild("in"),n=e.getChild("sync")&&e.getChild("sync").getChild("out"),r=t?t.children:[],i=n?n.children:[];r=r.map(function(e){return{phone:e.data,jid:e.getAttributeValue("jid")}}),i=i.map(function(e){return{phone:e.data,jid:e.getAttributeValue("jid")}}),u.send("contacts_sync",[e.getAttributeValue("id"),r,i])}function L(t){var n={},r=t.getChild("status"),i=r?r.children:[];i.forEach(function(t){n[t.getAttributeValue("jid")]=e(t.data)}),u.send("contacts_gotStatus",[t.getAttributeValue("id"),n])}function A(e){var t=e.getAttributeValue("from"),n=e.getChild("list"),r,i=n.getAllChildren("user");for(var s=0,o=i.length;s<o;s++)r=i[s],u.send("contact_gotProfilePictureId",[r.getAttributeValue("jid"),r.getAttributeValue("id")])}function O(e,t){var n=t.getChild("media");if(n){var r=n.getAttributeValue("url"),i=n.getAttributeValue("resume");i||(i=0),r?u.send("media_uploadRequestSuccess",[e,r,i]):u.send("media_uploadRequestFailed",[e])}else{var s=t.getChild("duplicate");if(s){var r=s.getAttributeValue("url");u.send("media_uploadRequestDuplicate",[e,r])}else u.send("media_uploadRequestFailed",[e])}}var e=CoSeMe.utils.stringFromUtf8,t=CoSeMe.utils.utf8FromString,n=new CoSeMe.common.Logger("ReaderThread"),r=[],i=0,s=120,o=null,u,a=CoSeMe.protocol.Tree,f={result:function(e,t,n){var i=n.getChild("props");i?l(i.getAllChildren()):t in r&&(r[t](n),delete r[t])},error:function(e,t,n){t in r&&(r[t](n),delete r[t])},get:function(e,t,n){var r=n.getChild(0);if(n.getAttributeValue("xmlns")==="urn:xmpp:ping")u.onPing&&u.onPing(t),u.send("ping",[t]);else if(a.tagEquals(r,"query")&&n.getAttributeValue("from")&&"http://jabber.org/protocol/disco#info"==r.getAttributeValue("xmlns")){var i=r.getAttributeValue("pin"),s=r.getAttributeValue("timeout");i}},set:function(e,t,n){var r=n.getChild(0);if(a.tagEquals(r,"query")){var i=r.getAttributeValue("xmlns");if(i=="jabber:iq:roster"){var s=r.getAllChildren("item");s.forEach(function(e){var t=e.getAttributeValue("jid"),n=e.getAttributeValue
("subscription"),r=e.getAttributeValue("ask")})}}}},M=!1;return{set socket(e){e?(o=e,o.reader.onTree=h,o.reader.resume(),M=!0):(o.reader.onStreamStart=undefined,o.reader.onTree=undefined,o.onconnectionclosed=undefined,o.onconnectionlost=undefined,o=e,M=!1)},get requests(){return r},parseRequestUpload:O,parsePingResponse:d,parseGroupInfo:v,parseGetGroups:m,parseGetPicture:g,parseGroupCreated:y,parseAddedParticipants:b,parseRemovedParticipants:w,parseSetPicture:E,parseGroupEnded:S,parseGroupSubject:x,parseGroups:T,parseParticipants:N,parseLastOnline:C,parseContactsSync:k,parseContactsStatus:L,parseGetPictureIds:A,set signalInterface(e){u=e},get signalInterface(){return u},isAlive:function(){return M},terminate:function(){return!0},sendDisconnected:function(e){u.send("disconnected",[e])}}}()),CoSeMe.namespace("yowsup.connectionmanager",function(){function r(e,t){i[e].forEach(function(e){try{e.apply(undefined,t)}catch(r){n.error("FireEvent exception!",r)}})}function s(e,t,n,r){return new CoSeMe.protocol.Tree(e,{attributes:t,children:n,data:r})}function u(e,t,n){var r=n?{media:n}:undefined,i=s(t,r),u=s("chatstate",{to:e},[i]);o._writeNode(u)}function a(e,t,n,r){var i=o.makeId(e+"_group_participants_"),u=[];r.forEach(function(e){u.push(s("participant",{jid:e}))});var a=s(e,undefined,u),f=s("iq",{id:i,type:"set",to:n,xmlns:"w:g2"},[a]);o.readerThread.requests[i]=t,o._writeNode(f)}function f(e,t,n){var r=[],i=o.makeId("set_picture_"),u=s("picture",{},null,n);r.push(u);if(t){var a=s("picture",{type:"preview"},null,t);r.push(a)}var f=s("iq",{id:i,to:e,type:"set",xmlns:"w:profile:picture"},r,null);return o.readerThread.requests[i]=o.readerThread.parseSetPicture,o._writeNode(f),i}function l(e){var t=o.makeId("get_picture_"),n=s("picture"),r=s("iq",{id:t,type:"get",to:e,xmlns:"w:profile:picture"},[n]);o.readerThread.requests[t]=o.readerThread.parseGetPicture,o._writeNode(r)}function c(){h("S40","en","GB"),p(),d(),m()}function h(e,t,r){n.log("Sending client config...");var i=o.makeId("config_"),u=s("config",{platform:e,lg:t,lc:r,clear:"0"}),a=s("iq",{id:i,type:"set",to:CoSeMe.config.domain,xmlns:"urn:xmpp:whatsapp:push"},[u]);o._writeNode(a)}function p(){n.log("Asking for server properties...");var e=o.makeId("get_server_properties_"),t=s("iq",{type:"get",to:CoSeMe.config.domain,xmlns:"w"},[s("props")]);o._writeNode(t)}function d(){n.log("Asking for groups...");var e=o.makeId("get_groups_");return v(e,"participating"),o.readerThread.requests[e]=o.readerThread.parseGetGroups,e}function v(e,t){var n=s(t,null),r=s("iq",{id:e,type:"get",to:"g.us",xmlns:"w:g2"},[n]);o._writeNode(r)}function m(){var e=o.makeId("privacylist_"),t=s("list",{name:"default"}),n=s("query",undefined,[t]),r=s("iq",{id:e,type:"get",xmlns:"jabber:iq:privacy"},[n]);o._writeNode(r)}var e=CoSeMe.utils.stringFromUtf8,t=CoSeMe.utils.utf8FromString,n=new CoSeMe.common.Logger("ConnectionManager"),i={auth_success:[],auth_fail:[],message_received:[],image_received:[],vcard_received:[],video_received:[],audio_received:[],location_received:[],message_error:[],receipt_messageSent:[],receipt_messageDelivered:[],receipt_visible:[],receipt_broadcastSent:[],status_dirty:[],presence_updated:[],presence_available:[],presence_unavailable:[],group_subjectReceived:[],group_createSuccess:[],group_createFail:[],group_endSuccess:[],group_gotInfo:[],group_infoError:[],group_addParticipantsSuccess:[],group_removeParticipantsSuccess:[],group_gotParticipants:[],group_gotParticipating:[],group_setSubjectSuccess:[],group_messageReceived:[],group_imageReceived:[],group_vcardReceived:[],group_videoReceived:[],group_audioReceived:[],group_locationReceived:[],group_setPictureSuccess:[],group_setPictureError:[],group_gotPicture:[],group_gotGroups:[],notification_contactProfilePictureUpdated:[],notification_contactProfilePictureRemoved:[],notification_groupCreated:[],notification_groupSubjectUpdated:[],notification_groupPictureUpdated:[],notification_groupPictureRemoved:[],notification_groupParticipantAdded:[],notification_groupParticipantRemoved:[],notification_status:[],contact_gotProfilePictureId:[],contact_gotProfilePicture:[],contact_typing:[],contact_paused:[],contacts_sync:[],contacts_gotStatus:[],profile_setPictureSuccess:[],profile_setPictureError:[],profile_setStatusSuccess:[],ping:[],pong:[],got_properties:[],disconnected:[],media_uploadRequestSuccess:[],media_uploadRequestFailed:[],media_uploadRequestDuplicate:[]},o={readerThread:CoSeMe.yowsup.readerThread,autoPong:!0,state:0,socket:null,jid:null,out:null,currKeyId:0,_writeNode:function(e){n.log("Write node called with ",e),o.state==2&&o.out.write(e,this._onErrorSendDisconnected)},_onErrorSendDisconnected:function(e){e&&o.state!==0&&(o.state=0,o.readerThread.socket=null,o.readerThread.sendDisconnected(e),n.error("Error writing!",e))},getMessageNode:function(e,t){var n=[];t instanceof Array?n=n.concat(t):n.push(t);var r=Math.floor(Date.now()/1e3)+"-"+o.currKeyId,i=s("message",{to:e,type:t.tag==="media"?"media":"text",id:r},n);return o.currKeyId++,i},sendMessage:function(){var e=Array.prototype.slice.call(arguments),t=e.shift(),n=t.apply(o,e),r=typeof e[0]=="string"||e[0]instanceof String?e[0]:"broadcast",i=o.getMessageNode(r,n);return o._writeNode(i),i.getAttributeValue("id")},mediaNode:function(){var e=Array.prototype.slice.call(arguments),n=e.shift(),r=n.apply(o,e),i=e[1],u=t(e[2]),a=e[3];typeof a!="string"&&(a=a.toString());var f={xmlns:"urn:xmpp:whatsapp:mms",type:r,file:u,size:a,url:i},l=e[4];l&&(f.encoding="raw");var c=e[5];c&&(f.origin="live");var h=e[6];h&&(f.seconds=h.toString(10));var p=s("media",{xmlns:"urn:xmpp:whatsapp:mms",type:r,file:u,size:a,url:i},null,l);return p},sendReceipt:function(e,t,n){attributes={to:e,id:t,t:Date.now()},n&&(attributes.type=n),o._writeNode(s("receipt",attributes))},sendNotificationAck:function(e,t,n){var r={"class":"notification",id:t,to:e};n&&(r.type=n),o._writeNode(s("ack",r))},sendReceiptErrorEncrypted:function(e,t){var n={type:"error",id:t,to:e};o._writeNode(s("receipt"
,n,[s("error",{type:"plaintext-only"})]))},getReceiptAck:function(e,t,n,r,i){var o={"class":"receipt",id:t,to:e};return i&&(o.from=i),n&&(o.type=n),r&&(o.participant=r),s("ack",o)},getSubjectMessage:function(e,t,n){var r=s("message",{to:e,type:"subject",id:t},[n]);return r},iqId:0,verbose:!0,makeId:function(e){o.iqId++;var t;return o.verbose?t=e+o.iqId:t=o.iqId.toString(16),t},sendKeepalive:function(){o._writeNode(null)},sendPing:function(){var e=o.makeId("ping_"),t=s("iq",{type:"get",xmlns:"w:p",to:o.domain,id:e});o._writeNode(t)},sendPong:function(e){var t=s("iq",{type:"result",to:o.domain,id:e});o._writeNode(t)}},g={is_online:function(){return o.socket&&o.socket.socket&&o.socket.socket.readyState==="open"},auth_login:function(e,t,i,s){n.log("auth_login called for",e),CoSeMe.auth.authenticate(e,t,i,s,function(t,i){try{!t&&i?(o.socket=i,o.expiration=i.expiration,o.socket.onconnectionclosed=o._onErrorSendDisconnected,o.socket.onconnectionlost=o._onErrorSendDisconnected,o.readerThread.socket=o.socket,o.readerThread.signalInterface={onPing:o.autoPong?o.sendPong:null,onUnknownNotification:o.sendNotificationAck,onEncryptedMessage:o.sendReceiptErrorEncrypted,send:r},o.jid=o.socket.jid,o.out=o.socket.writer,o.state=2,o.domain=CoSeMe.config.domain,c(),r("auth_success",[e,null])):(n.warn("Authentication failed: ",t),r("auth_fail",[e,null,t]))}catch(s){n.error("Error authenticating!",s),o.state=0,r("auth_fail",[e,null])}})},message_send:o.sendMessage.bind(o,function(e,n){return n=t(n),s("body",undefined,undefined,n)}),typing_send:function(e){u(e,"composing")},typing_paused:function(e){u(e,"paused")},message_imageSend:o.sendMessage.bind(o,o.mediaNode.bind(o,function(){return"image"})),message_videoSend:o.sendMessage.bind(o,o.mediaNode.bind(o,function(){return"video"})),message_audioSend:o.sendMessage.bind(o,o.mediaNode.bind(o,function(){return"audio"})),message_locationSend:o.sendMessage.bind(o,function(e,t,n,r){return s("media",{xmlns:"urn:xmpp:whatsapp:mms",type:"location",latitude:t,longitude:n},null,r)}),message_vcardSend:o.sendMessage.bind(o,function(e,n,r){r=t(r);var i=s("vcard",{name:r},null,n);return s("media",{xmlns:"urn:xmpp:whatsapp:mms",type:"vcard"},[i])}),message_ack:function(e,t,n){o.sendReceipt(e,t,n)},notification_ack:function(e,t,n){o.sendNotificationAck(e,t,n)},delivered_ack:function(e,t,n,r,i){o._writeNode(o.getReceiptAck(e,t,n,r,i))},visible_ack:function(e,t){o._writeNode(o.getReceiptAck(e,t,"visible"))},read_ack:function(e,t){o._writeNode(o.getReceiptAck(e,t,"read"))},subject_ack:function(e,t){n.log("Sending subject recv receipt...");var r=s("received",{xmlns:"urn:xmpp:receipts"}),i=o.getSubjectMessage(e,t,r);o._writeNode(i)},keepalive:o.sendKeepalive,ping:o.sendPing,pong:o.sendPong,group_getInfo:function(e){var t=o.makeId("get_groupv2_info_"),n=s("query"),r=s("iq",{id:t,type:"get",to:e,xmlns:"w:g2"},[n]);o.readerThread.requests[t]=o.readerThread.parseGroupInfo,o._writeNode(r)},group_getPicture:l,group_create:function(e){var n=o.makeId("create_group_"),r=s("create",{subject:t(e)}),i=s("iq",{id:n,type:"set",to:"g.us",xmlns:"w:g2"},[r]);return o.readerThread.requests[n]=o.readerThread.parseGroupCreated,o._writeNode(i),n},group_addParticipants:function(e,t){a("add",o.readerThread.parseAddedParticipants,e,t)},group_removeParticipants:function(e,t){a("remove",o.readerThread.parseRemovedParticipants,e,t)},group_setPicture:f,group_end:function(e){var t=o.makeId("leave_group_"),n=[];n.push(s("group",{id:e}));var r=s("leave",undefined,n),i=s("iq",{id:t,type:"set",to:"g.us",xmlns:"w:g2"},[r]);o.readerThread.requests[t]=o.readerThread.parseGroupEnded,o._writeNode(i)},group_setSubject:function(e,n){n=t(n);var r=o.makeId("set_group_subject_"),i=s("subject",{value:n}),u=s("iq",{id:r,type:"set",to:e,xmlns:"w:g2"},[i]);o.readerThread.requests[r]=o.readerThread.parseGroupSubject,o._writeNode(u)},group_getParticipants:function(e){var t=o.makeId("get_participants_"),n=s("list"),r=s("iq",{id:t,type:"get",to:e,xmlns:"w:g2"},[n]);o.readerThread.requests[t]=o.readerThread.parseParticipants,o._writeNode(r)},group_getParticipating:function(){return d()},presence_sendAvailable:function(e){var n={type:"available"};e&&(n.name=t(e));var r=s("presence",n);o._writeNode(r)},presence_request:function(e){g.presence_subscribe(e);var t=o.makeId("last_"),n=s("iq",{to:e,type:"get",id:t,xmlns:"jabber:iq:last"},[s("query")]);o.readerThread.requests[t]=o.readerThread.parseLastOnline,o._writeNode(n)},presence_sendUnavailable:function(){var e=s("presence",{type:"unavailable"});o._writeNode(e)},presence_sendAvailableForChat:function(e){var n={type:"active"};e&&(n.name=t(e));var r=s("presence",n);o._writeNode(r)},presence_subscribe:function(e){var t=s("presence",{type:"subscribe",to:e});o._writeNode(t)},presence_unsubscribe:function(e){var t=s("presence",{type:"unsubscribe",to:e});o._writeNode(t)},contacts_sync:function(e){var t=o.makeId("sync_"),n=o.jid,r=s("sync",{mode:"full",context:"background",sid:CoSeMe.time.utcTimestamp(),last:"true",index:"0"},e.map(function(e){return s("user",undefined,undefined,e)})),i=s("iq",{to:n,type:"get",id:t,xmlns:"urn:xmpp:whatsapp:sync"},[r]);return o.readerThread.requests[t]=o.readerThread.parseContactsSync,o._writeNode(i),t},contacts_getStatus:function(e){var t=o.makeId("getstatus_"),n=s("iq",{to:CoSeMe.config.domain,type:"get",id:t,xmlns:"status"},[s("status",undefined,e.map(function(e){return s("user",{jid:e})}))]);return o.readerThread.requests[t]=o.readerThread.parseContactsStatus,o._writeNode(n),t},contact_getProfilePicture:l,picture_getIds:function(e){var t=o.makeId("get_picture_ids_");o.readerThread.requests[t]=o.readerThread.parseGetPictureIds;var n=[];e.forEach(function(e){n.push(s("user",{jid:e}))});var r=s("list",{},n),i=s("iq",{id:t,type:"get",xmlns:"w:profile:picture"},[r]);o._writeNode(i)},profile_getPicture:function(){l(o.jid)},profile_setStatus:function(e){e=t(e);var n=o.makeId("sendsetstatus_"),r=s("status",undefined,undefined,e),i=s("iq",{to:"s.whatsapp.net",type:"set"
,id:n,xmlns:"status"},[r]);return o._writeNode(i),n},profile_setPicture:function(e,t){return f(o.jid,e,t)},ready:function(){return o.readerThread.isAlive()?(n.warn("Reader already started"),0):(n.log("Starting reader..."),1)},getVersion:function(){return CoSeMe.config.tokenData.v},getExpirationDate:function(){return o.expiration},disconnect:function(e){n.log("Disconnect sequence initiated..."),o.readerThread.isAlive()&&(n.log("Sending term signal to reader thread"),o.readerThread.terminate(),o.socket.socket.close(),o.readerThread.sendDisconnected(e)),n.log("Disconnected!",e),o.state=0},media_requestUpload:function(e,t,n,r){var i=o.makeId("upload_");o.readerThread.requests[i]=o.readerThread.parseRequestUpload.bind(undefined,e),typeof n!="string"&&(n=n.toString(10));var u={hash:e,type:t,size:n};r&&(u.orighash=r);var a=s("media",u),f=s("iq",{id:i,to:"s.whatsapp.net",type:"set",xmlns:"w:m"},[a]);o._writeNode(f)},message_broadcast:o.sendMessage.bind(undefined,function(e,t){var n=[];e.forEach(function(e){n.push(s("to",{jid:e}))});var r=s("broadcast",null,n),i=s("body",null,null,t);return[r,i]}),clientconfig_send:function(e,t,n,r){var i=o.makeId("config_"),u=s("config",{xmlns:"urn:xmpp:whatsapp:push",sound:e,id:t,preview:n?"1":"0",platform:r}),a=s("iq",{id:i,type:"set",to:o.domain},[u]);o._writeNode(a)},group_getGroups:function(e){var t=o.makeId("get_groups_");o.readerThread.requests[t]=o.readerThread.parseGroups;var n=s("list",{xmlns:"w:g2",type:e}),r=s("iq",{id:t,type:"get",to:"g.us"},[n]);o._writeNode(r)},picture_get:function(e){var t=o.makeId("get_picture_");o.readerThread.requests[t]=o.readerThread.parseGetPicture;var n=s("picture",{xmlns:"w:profile:picture",type:"image"}),r=s("iq",{id:t,to:e,type:"get"},[n]);o._writeNode(r)},status_update:function(e){e=t(e);var n=s("body",null,null,e),r=o.getMessageNode("s.us",n);return o._writeNode(r),r.getAttributeValue("id")}};return{get methods(){return g},get signals(){return i},fireEvent:r,get jid(){return o.jid}}}()),CoSeMe.namespace("contacts",function(){"use strict";function s(e){var t=r[e];delete r[e],t&&t.apply(this,[].slice.call(arguments,1))}function o(e,n){var i=t.call("contacts_sync",[e]);r[i]=n}function u(e,n){var i=t.call("contacts_getStatus",[e]);r[i]=n}function a(e,t,n){var r={c:[]};return e.forEach(function(e){r.c.push(f(1,e,n[e.jid]))}),t.forEach(function(e){r.c.push(f(0,e))}),r}function f(e,t,n){var r={w:e,p:t.phone,n:t.jid.split("@")[0],get t(){return console.warn("Deprecated with the new sync method."),undefined}};return e&&(r.s=n),r}var e=new CoSeMe.common.Logger("contacts"),t=CoSeMe.yowsup.getMethodsInterface(),n=CoSeMe.yowsup.getSignalsInterface(),r={},i=[];return n.registerListener("contacts_sync",s),n.registerListener("contacts_gotStatus",s),{setCredentials:function(){console.warn("Deprecated and useless. Please, remove.")},addContacts:function(t){Array.isArray(t)||(t=[t]),i=i.concat(t),e.log("Contacts:",i)},clearContacts:function(){i=[]},query:function(t,n){if(i.length===0)return;o(i,function(e,r){if(e.length===0&&r.length===0)return n("invalid-sync-response");var i=e.map(function(e){return e.jid});u(i,function(i){if(e.length>0&&Object.keys(i).length===0)return n("invalid-status-response");var s=a(e,r,i);t(s)})})}}}());
